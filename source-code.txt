(Files content cropped to 300k characters, download full ingest to see more)
================================================
FILE: StreamFlow.slnx
================================================
<Solution>
  <Project Path="BlazorUI/BlazorUI.csproj" />
  <Project Path="Contracts/Contracts.csproj" Id="4d77dadc-ae33-4748-a427-55d667ce03bb" />
  <Project Path="Entities/Entities.csproj" Id="3428a432-5242-4c7f-9725-7aa2c1d36d45" />
  <Project Path="ERPApi/ERPApi.csproj" Id="cf5c10e4-85fd-4e4c-9907-10221aaa4e51" />
  <Project Path="InventoryService/InventoryService.csproj" />
  <Project Path="OrderApi/OrderApi.csproj" />
  <Project Path="PackingService/PackingService.csproj" />
  <Project Path="PickingService/PickingService.csproj" Id="5d520d72-b190-43b6-b8d5-a1166ff39e83" />
  <Project Path="StreamFlow.Tests/StreamFlow.Tests.csproj" />
</Solution>



================================================
FILE: wms-ecom-messaging-flow.drawio
================================================
<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.9">
  <diagram id="40HgFmWMCiKAjGtGquQa" name="page-1">
    <mxGraphModel dx="459" dy="253" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1920" pageHeight="1200" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="MRMKahIGyIiRDAnymcXO-1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="MRMKahIGyIiRDAnymcXO-2" target="MRMKahIGyIiRDAnymcXO-4" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="500" y="300" />
              <mxPoint x="500" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-2" value="&lt;div&gt;Order Api&lt;/div&gt;[create-new-order]" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="280" y="280" width="200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-3" value="create-order-response" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rotation=0;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="558.75" y="330" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-4" value="create-order-request" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rotation=0;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="290" width="118.75" height="20" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-6" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="MRMKahIGyIiRDAnymcXO-8" target="MRMKahIGyIiRDAnymcXO-3" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="740" y="340" />
              <mxPoint x="740" y="340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--7" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="MRMKahIGyIiRDAnymcXO-8" target="MRMKahIGyIiRDAnymcXO-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="880" y="370" />
              <mxPoint x="880" y="370" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-8" value="ERP Api" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="280" width="520" height="80" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-35" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="MRMKahIGyIiRDAnymcXO-10" target="MRMKahIGyIiRDAnymcXO-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-10" value="erp.db" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="840" y="400" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TE5TW754HXof8P-l7QC5-3" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="MRMKahIGyIiRDAnymcXO-11" target="TE5TW754HXof8P-l7QC5-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-11" value="MassTransit Internally Processer&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="620" y="480" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-12" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=1.011;entryY=0.755;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="MRMKahIGyIiRDAnymcXO-3" target="MRMKahIGyIiRDAnymcXO-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-13" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=-0.006;entryY=0.25;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="MRMKahIGyIiRDAnymcXO-4" target="MRMKahIGyIiRDAnymcXO-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-14" value="erp-dead-letter" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.deadLetterChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="558.75" y="380" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="MRMKahIGyIiRDAnymcXO-18" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.076;entryY=1.005;entryDx=0;entryDy=0;entryPerimeter=0;endArrow=none;endFill=0;startArrow=classic;startFill=1;rounded=1;" parent="1" source="MRMKahIGyIiRDAnymcXO-14" target="MRMKahIGyIiRDAnymcXO-8" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="800" y="390" />
              <mxPoint x="800" y="360" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="TE5TW754HXof8P-l7QC5-2" value="&lt;b&gt;OrderCreated&lt;/b&gt;&lt;div&gt;[Topic]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="630" y="560" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="fpS1qffCRi1iXtPLFVmR-9" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="fpS1qffCRi1iXtPLFVmR-3" target="fpS1qffCRi1iXtPLFVmR-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fpS1qffCRi1iXtPLFVmR-3" value="order-created" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="650" y="640" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="fpS1qffCRi1iXtPLFVmR-4" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0;entryDx=60;entryDy=0;entryPerimeter=0;rounded=1;" parent="1" source="TE5TW754HXof8P-l7QC5-2" target="fpS1qffCRi1iXtPLFVmR-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-2" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="fpS1qffCRi1iXtPLFVmR-6" target="rvFPTgMsHZ1ddfQbSfn_-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-18" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="fpS1qffCRi1iXtPLFVmR-6" target="rvFPTgMsHZ1ddfQbSfn_-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-29" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="fpS1qffCRi1iXtPLFVmR-6" target="jA9v_CS6Pw23i_MB0t5T-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fpS1qffCRi1iXtPLFVmR-6" value="Inventory Service" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="630" y="720" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-38" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="rvFPTgMsHZ1ddfQbSfn_-1" target="rvFPTgMsHZ1ddfQbSfn_-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-39" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="rvFPTgMsHZ1ddfQbSfn_-1" target="rvFPTgMsHZ1ddfQbSfn_-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-1" value="Content-Based-Routing&amp;nbsp;" style="html=1;strokeWidth=2;outlineConnect=0;dashed=0;align=center;fontSize=12;fillColor=#c0f5a9;verticalLabelPosition=bottom;verticalAlign=top;shape=mxgraph.eip.content_based_router;fontStyle=0;labelPosition=center;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="643.3299999999999" y="800" width="133.34" height="80" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--28" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="rvFPTgMsHZ1ddfQbSfn_-4" target="rvFPTgMsHZ1ddfQbSfn_-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-4" value="&lt;b&gt;[if stock &amp;gt;= ordered] StockReserved&lt;/b&gt;&lt;br&gt;&lt;div&gt;[Topic]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="880" y="780" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--30" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="rvFPTgMsHZ1ddfQbSfn_-6" target="rvFPTgMsHZ1ddfQbSfn_-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-6" value="&lt;div&gt;&lt;b style=&quot;background-color: transparent; color: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));&quot;&gt;[if stock == 0]&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;StockUnvailable&lt;/b&gt;&lt;br&gt;&lt;div&gt;[Topic]&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="880" y="860" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-10" value="StockUnvailable" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1079" y="870" width="121" height="20" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--34" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;rounded=1;" parent="1" source="rvFPTgMsHZ1ddfQbSfn_-13" target="xnCd3lY-Oocrh5LXSUC--9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-13" value="&lt;div&gt;picking-stock-reserved&lt;/div&gt;&lt;div&gt;[x-max-priority=10]&lt;/div&gt;&lt;div&gt;DK order highest priority&lt;/div&gt;" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1080" y="790" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="rvFPTgMsHZ1ddfQbSfn_-17" value="inventory-dead-letter" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.deadLetterChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="730" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--18" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--9" target="xnCd3lY-Oocrh5LXSUC--15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--39" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--9" target="xnCd3lY-Oocrh5LXSUC--19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-30" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.05;exitY=0.012;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="xnCd3lY-Oocrh5LXSUC--9" target="jA9v_CS6Pw23i_MB0t5T-10" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1290" y="760" />
              <mxPoint x="1115" y="760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--9" value="Picking Service" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1280" y="840" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--15" value="picking-dead-letter" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.deadLetterChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1520" y="850" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--40" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--19" target="xnCd3lY-Oocrh5LXSUC--20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--19" value="&lt;div&gt;&lt;span style=&quot;background-color: transparent;&quot;&gt;&lt;b&gt;OrderPicked&lt;/b&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(255, 255, 255), rgb(18, 18, 18));&quot;&gt;[Topic]&lt;/span&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="1300" y="770" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--41" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--20" target="xnCd3lY-Oocrh5LXSUC--21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--20" value="&lt;span style=&quot;font-weight: normal;&quot;&gt;packing-order-picked&lt;/span&gt;" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=middle;labelBackgroundColor=#ffffff;verticalAlign=middle;labelPosition=right;fontStyle=1;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1320" y="720" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--25" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--21" target="xnCd3lY-Oocrh5LXSUC--24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--42" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--21" target="xnCd3lY-Oocrh5LXSUC--22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--21" value="Packing Service" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1280" y="610" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--43" value="" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--22" target="xnCd3lY-Oocrh5LXSUC--23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--22" value="&lt;b&gt;OrderPacked&lt;/b&gt;&lt;br&gt;&lt;div&gt;[Topic]&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#60a917;fontColor=#ffffff;strokeColor=#2D7600;" parent="1" vertex="1">
          <mxGeometry x="1300" y="540" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--23" value="packing-order-picked" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=middle;labelBackgroundColor=#ffffff;verticalAlign=middle;labelPosition=right;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1320" y="480" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--24" value="packing-dead-letter" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.deadLetterChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="1520" y="620" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="xnCd3lY-Oocrh5LXSUC--45" style="edgeStyle=orthogonalEdgeStyle;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.921;entryY=1.029;entryDx=0;entryDy=0;entryPerimeter=0;rounded=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--23" target="MRMKahIGyIiRDAnymcXO-8" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1280" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-4" value="invalid-order" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.invalidMessageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;" parent="1" vertex="1">
          <mxGeometry x="560" y="430" width="120" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-7" value="erp-stock-reserved" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;labelPosition=center;spacing=2;spacingRight=0;spacingBottom=0;spacingTop=16;" parent="1" vertex="1">
          <mxGeometry x="920" y="490" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-10" value="erp-order-picked" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;spacingTop=16;" parent="1" vertex="1">
          <mxGeometry x="1080" y="490" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-19" value="erp-order-packed" style="strokeWidth=1;outlineConnect=0;dashed=0;align=center;html=1;fontSize=8;shape=mxgraph.eip.messageChannel;verticalLabelPosition=bottom;labelBackgroundColor=#ffffff;verticalAlign=top;rounded=1;spacingTop=16;" parent="1" vertex="1">
          <mxGeometry x="1160" y="490" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-25" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.375;entryY=1.016;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="jA9v_CS6Pw23i_MB0t5T-7" target="MRMKahIGyIiRDAnymcXO-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-27" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.681;entryY=1.029;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="jA9v_CS6Pw23i_MB0t5T-10" target="MRMKahIGyIiRDAnymcXO-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-28" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.838;entryY=1.025;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="jA9v_CS6Pw23i_MB0t5T-19" target="MRMKahIGyIiRDAnymcXO-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-31" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="xnCd3lY-Oocrh5LXSUC--21" target="jA9v_CS6Pw23i_MB0t5T-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="jA9v_CS6Pw23i_MB0t5T-34" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.997;entryY=0.479;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.115;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="MRMKahIGyIiRDAnymcXO-8" target="jA9v_CS6Pw23i_MB0t5T-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>



================================================
FILE: BlazorUI/_Imports.razor
================================================
﻿@using System.Net.Http
@using System.Net.Http.Json
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.AspNetCore.Components.Web.Virtualization
@using Microsoft.AspNetCore.Components.WebAssembly.Http
@using Microsoft.JSInterop
@using BlazorUI
@using BlazorUI.Layout



================================================
FILE: BlazorUI/App.razor
================================================
﻿<Router AppAssembly="@typeof(App).Assembly">
    <Found Context="routeData">
        <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
        <FocusOnNavigate RouteData="@routeData" Selector="h1" />
    </Found>
    <NotFound>
        <PageTitle>Not found</PageTitle>
        <LayoutView Layout="@typeof(MainLayout)">
            <p role="alert">Sorry, there's nothing at this address.</p>
        </LayoutView>
    </NotFound>
</Router>



================================================
FILE: BlazorUI/BlazorUI.csproj
================================================
<Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">

  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly" Version="9.0.10" />
    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.DevServer" Version="9.0.10" PrivateAssets="all" />
    <PackageReference Include="Microsoft.Extensions.Http" Version="9.0.10" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\Contracts\Contracts.csproj" />
    <ProjectReference Include="..\Entities\Entities.csproj" />
  </ItemGroup>

</Project>



================================================
FILE: BlazorUI/Program.cs
================================================
using Microsoft.AspNetCore.Components.Web;
using Microsoft.AspNetCore.Components.WebAssembly.Hosting;
using BlazorUI;
using BlazorUI.Services;

var builder = WebAssemblyHostBuilder.CreateDefault(args);
builder.RootComponents.Add<App>("#app");
builder.RootComponents.Add<HeadOutlet>("head::after");

// Configure HttpClient for OrderApi
builder.Services.AddScoped(sp => new HttpClient 
{ 
    BaseAddress = new Uri("https://localhost:7027") 
});

// Configure named HttpClient for ERPApi
builder.Services.AddHttpClient("ERPApi", client =>
{
    client.BaseAddress = new Uri("https://localhost:7033");
});

// Configure HttpClient for SeqLogService (via ERPApi proxy to avoid CORS)
builder.Services.AddHttpClient<SeqLogService>(client =>
{
    client.BaseAddress = new Uri("https://localhost:7033");
});

await builder.Build().RunAsync();



================================================
FILE: BlazorUI/Layout/MainLayout.razor
================================================
﻿@inherits LayoutComponentBase

@Body



================================================
FILE: BlazorUI/Layout/MainLayout.razor.css
================================================
.page {
    position: relative;
    display: flex;
    flex-direction: column;
}

main {
    flex: 1;
}

.sidebar {
    background-image: linear-gradient(180deg, rgb(5, 39, 103) 0%, #3a0647 70%);
}

.top-row {
    background-color: #f7f7f7;
    border-bottom: 1px solid #d6d5d5;
    justify-content: flex-end;
    height: 3.5rem;
    display: flex;
    align-items: center;
}

    .top-row ::deep a, .top-row ::deep .btn-link {
        white-space: nowrap;
        margin-left: 1.5rem;
        text-decoration: none;
    }

    .top-row ::deep a:hover, .top-row ::deep .btn-link:hover {
        text-decoration: underline;
    }

    .top-row ::deep a:first-child {
        overflow: hidden;
        text-overflow: ellipsis;
    }

@media (max-width: 640.98px) {
    .top-row {
        justify-content: space-between;
    }

    .top-row ::deep a, .top-row ::deep .btn-link {
        margin-left: 0;
    }
}

@media (min-width: 641px) {
    .page {
        flex-direction: row;
    }

    .sidebar {
        width: 250px;
        height: 100vh;
        position: sticky;
        top: 0;
    }

    .top-row {
        position: sticky;
        top: 0;
        z-index: 1;
    }

    .top-row.auth ::deep a:first-child {
        flex: 1;
        text-align: right;
        width: 0;
    }

    .top-row, article {
        padding-left: 2rem !important;
        padding-right: 1.5rem !important;
    }
}



================================================
FILE: BlazorUI/Layout/NavMenu.razor
================================================
﻿<div class="top-row ps-3 navbar navbar-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="">BlazorUI</a>
        <button title="Navigation menu" class="navbar-toggler" @onclick="ToggleNavMenu">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</div>

<div class="@NavMenuCssClass nav-scrollable" @onclick="ToggleNavMenu">
    <nav class="nav flex-column">
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="" Match="NavLinkMatch.All">
                <span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> Home
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="counter">
                <span class="bi bi-plus-square-fill-nav-menu" aria-hidden="true"></span> Counter
            </NavLink>
        </div>
        <div class="nav-item px-3">
            <NavLink class="nav-link" href="weather">
                <span class="bi bi-list-nested-nav-menu" aria-hidden="true"></span> Weather
            </NavLink>
        </div>
    </nav>
</div>

@code {
    private bool collapseNavMenu = true;

    private string? NavMenuCssClass => collapseNavMenu ? "collapse" : null;

    private void ToggleNavMenu()
    {
        collapseNavMenu = !collapseNavMenu;
    }
}



================================================
FILE: BlazorUI/Layout/NavMenu.razor.css
================================================
.navbar-toggler {
    background-color: rgba(255, 255, 255, 0.1);
}

.top-row {
    min-height: 3.5rem;
    background-color: rgba(0,0,0,0.4);
}

.navbar-brand {
    font-size: 1.1rem;
}

.bi {
    display: inline-block;
    position: relative;
    width: 1.25rem;
    height: 1.25rem;
    margin-right: 0.75rem;
    top: -1px;
    background-size: cover;
}

.bi-house-door-fill-nav-menu {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-house-door-fill' viewBox='0 0 16 16'%3E%3Cpath d='M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5Z'/%3E%3C/svg%3E");
}

.bi-plus-square-fill-nav-menu {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-plus-square-fill' viewBox='0 0 16 16'%3E%3Cpath d='M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm6.5 4.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3a.5.5 0 0 1 1 0z'/%3E%3C/svg%3E");
}

.bi-list-nested-nav-menu {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='white' class='bi bi-list-nested' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M4.5 11.5A.5.5 0 0 1 5 11h10a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 1 3h10a.5.5 0 0 1 0 1H1a.5.5 0 0 1-.5-.5z'/%3E%3C/svg%3E");
}

.nav-item {
    font-size: 0.9rem;
    padding-bottom: 0.5rem;
}

    .nav-item:first-of-type {
        padding-top: 1rem;
    }

    .nav-item:last-of-type {
        padding-bottom: 1rem;
    }

    .nav-item ::deep a {
        color: #d7d7d7;
        border-radius: 4px;
        height: 3rem;
        display: flex;
        align-items: center;
        line-height: 3rem;
    }

.nav-item ::deep a.active {
    background-color: rgba(255,255,255,0.37);
    color: white;
}

.nav-item ::deep a:hover {
    background-color: rgba(255,255,255,0.1);
    color: white;
}

@media (min-width: 641px) {
    .navbar-toggler {
        display: none;
    }

    .collapse {
        /* Never collapse the sidebar for wide screens */
        display: block;
    }

    .nav-scrollable {
        /* Allow sidebar to scroll for tall menus */
        height: calc(100vh - 3.5rem);
        overflow-y: auto;
    }
}



================================================
FILE: BlazorUI/Pages/Counter.razor
================================================
﻿@page "/counter"

<PageTitle>Counter</PageTitle>

<h1>Counter</h1>

<p role="status">Current count: @currentCount</p>

<button class="btn btn-primary" @onclick="IncrementCount">Click me</button>

@code {
    private int currentCount = 0;

    private void IncrementCount()
    {
        currentCount++;
    }
}



================================================
FILE: BlazorUI/Pages/Home.razor
================================================
@page "/"
@inject HttpClient Http
@inject IHttpClientFactory HttpClientFactory
@inject BlazorUI.Services.SeqLogService SeqLogService
@using System.Text.Json
@using System.Text
@using Entities.Model
@using BlazorUI.Services
@implements IDisposable

<PageTitle>StreamFlow WMS</PageTitle>

<div class="min-h-screen bg-gray-50 p-4">
	<div class="max-w-full mx-auto mb-4">
		<h1 class="text-2xl font-bold text-gray-900">StreamFlow WMS - Order Management</h1>
		<p class="text-xs text-gray-600 mt-1">Create orders, monitor status, and view live logs</p>
	</div>

	<!-- Two Column Layout: Order Generator | Order Overview -->
	<div class="max-w-full mx-auto grid grid-cols-8 gap-4">

		<!-- LEFT: Order Generator (Compact - 2 cols) -->
		<div class="col-span-2 space-y-4">
			<div class="bg-white border border-gray-200 rounded-lg p-3">
				<h2 class="text-xs font-semibold text-gray-900 mb-2">Quick Actions</h2>
				<div class="space-y-2">
					<button @onclick="GenerateRandomOrder" class="w-full px-2 py-1.5 text-xs bg-gray-900 text-white font-medium rounded hover:bg-gray-800">
						Generate Order
					</button>
					<button @onclick="Generate5CountryOrders" class="w-full px-2 py-1.5 text-xs bg-purple-900 text-white font-medium rounded hover:bg-purple-800">
						5 Nordic Orders
					</button>
				</div>
			</div>

			<div class="bg-white border border-gray-200 rounded-lg p-3">
				<h2 class="text-xs font-semibold text-gray-900 mb-2">Order JSON</h2>
				<textarea @bind="orderJson" @bind:event="oninput" rows="12"
						  class="w-full px-2 py-1.5 text-xs font-mono border border-gray-300 rounded focus:ring-1 focus:ring-gray-900"
						  placeholder="Generate or paste JSON..."></textarea>

				@if (!string.IsNullOrEmpty(validationError))
				{
					<div class="mt-2 p-2 bg-red-50 border border-red-200 rounded">
						<p class="text-xs text-red-800">@validationError</p>
					</div>
				}

				<div class="mt-2 space-y-1">
					<button @onclick="SubmitOrder" disabled="@isSubmitting"
							class="w-full px-2 py-1.5 text-xs bg-gray-900 text-white font-medium rounded hover:bg-gray-800 disabled:bg-gray-400">
						@(isSubmitting ? "Submitting..." : "Submit Order")
					</button>
					<button @onclick="ClearEditor" class="w-full px-2 py-1.5 text-xs bg-white border border-gray-300 text-gray-700 font-medium rounded hover:bg-gray-50">
						Clear
					</button>
				</div>

				@if (!string.IsNullOrEmpty(responseMessage))
				{
					<div class="mt-2">
						@if (isSuccess)
						{
							<div class="p-2 bg-green-50 border border-green-200 rounded">
								<p class="text-xs text-green-800">Order #@orderNo</p>
							</div>
						}
						else
						{
							<div class="p-2 bg-red-50 border border-red-200 rounded">
								<p class="text-xs text-red-800">@responseMessage</p>
							</div>
						}
					</div>
				}
			</div>
		</div>

		<!-- MIDDLE: Order Overview (6 cols) -->
		<div class="col-span-6 space-y-4">
			<div class="bg-white border border-gray-200 rounded-lg p-3">
				<div class="flex gap-2">
					<input type="text" @bind="searchOrderNo" @bind:event="oninput" placeholder="Search by Order No..."
						   class="flex-1 px-3 py-1.5 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-gray-900" />
					<button @onclick="LoadOrders" class="px-3 py-1.5 text-xs bg-gray-900 text-white font-medium rounded hover:bg-gray-800">
						Refresh
					</button>
					<button @onclick="ClearFilter" class="px-3 py-1.5 text-xs bg-white border border-gray-300 text-gray-700 font-medium rounded hover:bg-gray-50">
						Clear
					</button>
				</div>
			</div>

			<div class="grid grid-cols-4 gap-2">
				<div class="bg-white border border-gray-200 rounded-lg p-2">
					<p class="text-xs text-gray-600">Total</p>
					<p class="text-lg font-bold text-gray-900">@orders.Count</p>
				</div>
				<div class="bg-white border border-gray-200 rounded-lg p-2">
					<p class="text-xs text-gray-600">Created</p>
					<p class="text-lg font-bold text-blue-600">@orders.Count(o => o.OrderState == "Created")</p>
				</div>
				<div class="bg-white border border-gray-200 rounded-lg p-2">
					<p class="text-xs text-gray-600">Processing</p>
					<p class="text-lg font-bold text-yellow-600">@orders.Count(o => o.OrderState == "StockReserved" || o.OrderState == "Picked")</p>
				</div>
				<div class="bg-white border border-gray-200 rounded-lg p-2">
					<p class="text-xs text-gray-600">Packed</p>
					<p class="text-lg font-bold text-green-600">@orders.Count(o => o.OrderState == "Packed")</p>
				</div>
			</div>

			<div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
				<div class="bg-gray-50 border-b border-gray-200 px-3 py-2">
					<h2 class="text-xs font-semibold text-gray-900">Order Overview (@FilteredOrders.Count() orders)</h2>
				</div>

				@if (isLoading)
				{
					<div class="flex items-center justify-center py-8">
						<div class="text-center">
							<div class="inline-block animate-spin rounded-full h-6 w-6 border-4 border-gray-900 border-t-transparent"></div>
							<p class="mt-2 text-xs text-gray-600">Loading orders...</p>
						</div>
					</div>
				}
				else if (orders.Count == 0)
				{
					<div class="text-center py-8">
						<p class="text-xs text-gray-500">No orders found. Create one using the form on the left!</p>
					</div>
				}
				else
				{
					<div class="overflow-x-auto">
						<table class="w-full text-xs">
							<thead class="bg-gray-50 border-b border-gray-200">
								<tr>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Order No</th>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Country</th>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Customer</th>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Items</th>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Total</th>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Status</th>
									<th class="px-3 py-2 text-left text-xs font-semibold text-gray-900">Created</th>
								</tr>
							</thead>
							<tbody class="divide-y divide-gray-200">
								@foreach (var order in FilteredOrders.OrderByDescending(o => o.OrderNo))
								{
									<tr class="hover:bg-gray-50 cursor-pointer" @onclick="() => OpenOrderDetails(order)">
										<td class="px-3 py-2 whitespace-nowrap">
											<span class="font-mono text-xs font-medium">@order.OrderNo</span>
										</td>
										<td class="px-3 py-2 whitespace-nowrap">
											<span class="inline-flex px-2 py-0.5 text-xs font-medium rounded bg-gray-100 text-gray-800">@order.CountryCode</span>
										</td>
										<td class="px-3 py-2 whitespace-nowrap text-xs">@order.Customer?.FirstName @order.Customer?.LastName</td>
										<td class="px-3 py-2 whitespace-nowrap text-xs">@order.OrderItems.Count items</td>
										<td class="px-3 py-2 whitespace-nowrap text-xs font-medium">@order.TotalAmount.ToString("N2") @order.Payment?.Currency</td>
										<td class="px-3 py-2 whitespace-nowrap">
											<span class="@GetStatusBadgeClass(order.OrderState)">@order.OrderState</span>
										</td>
										<td class="px-3 py-2 whitespace-nowrap text-xs">@order.CreatedAt.ToString("HH:mm:ss")</td>
									</tr>
								}
							</tbody>
						</table>
					</div>
				}
			</div>
		</div>
	</div>
</div>

<!-- Order Details Modal -->
@if (showOrderModal && selectedOrder != null)
{
	<div class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" @onclick="CloseOrderModal">
		<div class="bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden" @onclick:stopPropagation="true">
			<!-- Modal Header -->
			<div class="bg-gray-900 text-white px-6 py-4 flex justify-between items-center">
				<h2 class="text-lg font-bold">Order #@selectedOrder.OrderNo Details</h2>
				<button @onclick="CloseOrderModal" class="text-white hover:text-gray-300">
					<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</button>
			</div>

			<div class="overflow-y-auto" style="max-height: calc(90vh - 80px);">
				<!-- Order Information Section -->
				<div class="p-6 border-b border-gray-200">
					<h3 class="text-sm font-semibold text-gray-900 mb-4">Order Information</h3>
					<div class="grid grid-cols-2 gap-4 text-sm">
						<div>
							<p class="text-gray-600">Order Number</p>
							<p class="font-mono font-medium">#@selectedOrder.OrderNo</p>
						</div>
						<div>
							<p class="text-gray-600">Status</p>
							<span class="@GetStatusBadgeClass(selectedOrder.OrderState)">@selectedOrder.OrderState</span>
						</div>
						<div>
							<p class="text-gray-600">Customer</p>
							<p class="font-medium">@selectedOrder.Customer?.FirstName @selectedOrder.Customer?.LastName</p>
						</div>
						<div>
							<p class="text-gray-600">Country</p>
							<p class="font-medium">@selectedOrder.CountryCode</p>
						</div>
						<div>
							<p class="text-gray-600">Total Amount</p>
							<p class="font-medium">@selectedOrder.TotalAmount.ToString("N2") @selectedOrder.Payment?.Currency</p>
						</div>
						<div>
							<p class="text-gray-600">Created At</p>
							<p class="font-medium">@selectedOrder.CreatedAt.ToString("yyyy-MM-dd HH:mm:ss")</p>
						</div>
						<div class="col-span-2">
							<p class="text-gray-600">Shipping Address</p>
							<p class="font-medium">@selectedOrder.ShippingAddress?.Street, @selectedOrder.ShippingAddress?.City, @selectedOrder.ShippingAddress?.PostalCode</p>
						</div>
					</div>

					<!-- Order Items -->
					<div class="mt-4">
						<p class="text-gray-600 mb-2">Order Items (@selectedOrder.OrderItems.Count)</p>
						<div class="space-y-2">
							@foreach (var item in selectedOrder.OrderItems)
							{
								<div class="flex justify-between items-center bg-gray-50 p-2 rounded">
									<div>
										<p class="text-sm font-medium">@item.Name</p>
										<p class="text-xs text-gray-600">SKU: @item.Sku</p>
									</div>
									<div class="text-right">
										<p class="text-sm font-medium">@item.Quantity x @item.UnitPrice.ToString("N2")</p>
										<p class="text-xs text-gray-600">@((item.Quantity * item.UnitPrice).ToString("N2")) @selectedOrder.Payment?.Currency</p>
									</div>
								</div>
							}
						</div>
					</div>
				</div>

				<!-- Order Processing Logs Section -->
				<div class="p-6">
					<div class="flex justify-between items-center mb-4">
						<h3 class="text-sm font-semibold text-gray-900">Order Processing Logs</h3>
						<div class="text-xs text-gray-500 space-y-0.5">
							<div><span class="font-medium">OrderNo:</span> <span class="font-mono">@selectedOrder.OrderNo</span></div>
							<div><span class="font-medium">OrderId:</span> <span class="font-mono text-[10px]">@selectedOrder.Id</span></div>
						</div>
					</div>

					@if (isLoadingOrderLogs)
					{
						<div class="flex items-center justify-center py-8">
							<div class="text-center">
								<div class="inline-block animate-spin rounded-full h-6 w-6 border-4 border-gray-900 border-t-transparent"></div>
								<p class="mt-2 text-xs text-gray-600">Loading logs...</p>
							</div>
						</div>
					}
					else if (orderLogs.Count == 0)
					{
						<div class="text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
							<svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
							</svg>
							<p class="mt-2 text-sm font-medium text-gray-900">No logs found for this order</p>
							<p class="text-xs text-gray-500 mt-1">OrderId: <span class="font-mono">@selectedOrder.Id</span></p>
							<p class="text-xs text-gray-400 mt-2">Logs may not have been generated yet or may have expired in Seq</p>
						</div>
					}
					else
					{
						<div class="space-y-0.5">
							@foreach (var log in orderLogs)
							{
								var sourceContext = log.GetProperty("SourceContext");
								var service = log.GetProperty("Service");
								var message = log.GetRenderedMessage();

								<div class="flex items-start gap-3 px-2 py-1.5 hover:bg-gray-50 rounded text-xs border-l-2 font-mono @(log.Level == "Error" ? "border-red-500" : log.Level == "Warning" ? "border-yellow-500" : "border-blue-400")">
									<!-- Timestamp -->
									<span class="font-bold text-[12px] text-gray-600 flex-shrink-0 w-[80px]">
										@log.Timestamp.ToLocalTime().ToString("dd MMM yyyy HH:mm:ss.fff")
									</span>

									<!-- Service -->
									<span class="text-gray-700 flex-shrink-0 w-[120px] truncate" title="@service">
										@service
									</span>

									@*                                     <!-- SourceContext -->
                                    <span class="text-gray-600 flex-shrink-0 w-[300px] truncate text-[11px]" title="@sourceContext">
                                        @sourceContext
                                    </span>
 *@                                    
						                                    <!-- Message -->
									<span class="text-gray-900 flex-1 break-words">
										@message
									</span>
								</div>
							}
						</div>
					}
				</div>
			</div>
		</div>
	</div>
}

@code {
	private string orderJson = "";
	private string responseMessage = "";
	private string validationError = "";
	private string orderNo = "";
	private bool isSubmitting = false;
	private bool isSuccess = false;
	private List<Order> orders = new();
	private string searchOrderNo = "";
	private bool isLoading = true;
	private Timer? refreshTimer;

	// Order Details Modal
	private Order? selectedOrder = null;
	private bool showOrderModal = false;
	private List<SeqEvent> orderLogs = new();
	private bool isLoadingOrderLogs = false;

	private static readonly Random random = new Random();

	// Plus-sized fashion products for women
	private static readonly (string sku, string name, decimal price)[] fashionProducts = {
		("FASHION-001", "Plus Size Maxi Dress - Floral", 599.00m),
		("FASHION-002", "Curve Denim Jeans - Dark Blue", 499.00m),
		("FASHION-003", "Plus Size Blazer - Black", 899.00m),
		("FASHION-004", "Curve Tunic Top - White", 349.00m),
		("FASHION-005", "Plus Size Cardigan - Grey", 449.00m),
		("FASHION-006", "Curve Leggings - Black", 299.00m),
		("FASHION-007", "Plus Size Evening Dress - Navy", 1299.00m),
		("FASHION-008", "Curve Blouse - Burgundy", 399.00m),
		("FASHION-009", "Plus Size Skirt - A-Line", 549.00m),
		("FASHION-010", "Curve T-Shirt Pack (3) - Mixed", 399.00m),
		("FASHION-011", "Plus Size Coat - Winter", 1499.00m),
		("FASHION-012", "Curve Jumpsuit - Black", 799.00m)
	};

	// Country-specific data
	private static readonly Dictionary<string, (string[] firstNames, string[] lastNames, string[] cities, string[] streets, string countryCode, string currency, string state, string phonePrefix)> countryData = new()
	{
		["DK"] = (
			new[] { "Anders", "Mette", "Lars", "Anne", "Peter", "Sofie", "Michael", "Emma", "Henrik", "Julie" },
			new[] { "Hansen", "Nielsen", "Jensen", "Pedersen", "Andersen", "Christensen", "Larsen", "Sørensen", "Rasmussen", "Jørgensen" },
			new[] { "København", "Aarhus", "Odense", "Aalborg", "Esbjerg", "Randers", "Kolding", "Horsens", "Vejle", "Roskilde" },
			new[] { "Vestergade", "Nørregade", "Østergade", "Søndergade", "Hovedgaden", "Strandvejen", "Brogade", "Torvet" },
			"DK", "DKK", "Midtjylland", "+45"
		),
		["DE"] = (
			new[] { "Hans", "Anna", "Klaus", "Helga", "Wolfgang", "Greta", "Friedrich", "Ingrid", "Otto", "Brunhilde" },
			new[] { "Müller", "Schmidt", "Schneider", "Fischer", "Weber", "Meyer", "Wagner", "Becker", "Schulz", "Hoffmann" },
			new[] { "Berlin", "Hamburg", "München", "Köln", "Frankfurt", "Stuttgart", "Düsseldorf", "Dortmund", "Essen", "Leipzig" },
			new[] { "Hauptstraße", "Bahnhofstraße", "Kirchstraße", "Marktplatz", "Berliner Straße", "Schulstraße", "Gartenstraße", "Ringstraße" },
			"DE", "EUR", "Bayern", "+49"
		),
		["NO"] = (
			new[] { "Ole", "Ingrid", "Lars", "Astrid", "Bjørn", "Sigrid", "Erik", "Helga", "Magnus", "Solveig" },
			new[] { "Hansen", "Johansen", "Olsen", "Larsen", "Andersen", "Pedersen", "Nilsen", "Kristiansen", "Jensen", "Karlsen" },
			new[] { "Oslo", "Bergen", "Trondheim", "Stavanger", "Drammen", "Fredrikstad", "Kristiansand", "Sandnes", "Tromsø", "Sarpsborg" },
			new[] { "Storgata", "Kirkegata", "Havnegata", "Fjellveien", "Skogveien", "Parkveien", "Strandveien", "Torget" },
			"NO", "NOK", "Oslo", "+47"
		),
		["SE"] = (
			new[] { "Erik", "Anna", "Lars", "Ingrid", "Karl", "Astrid", "Gustav", "Maja", "Sven", "Karin" },
			new[] { "Andersson", "Johansson", "Karlsson", "Nilsson", "Eriksson", "Larsson", "Olsson", "Persson", "Svensson", "Gustafsson" },
			new[] { "Stockholm", "Göteborg", "Malmö", "Uppsala", "Västerås", "Örebro", "Linköping", "Helsingborg", "Jönköping", "Norrköping" },
			new[] { "Storgatan", "Kyrkogatan", "Stationsgatan", "Parkgatan", "Skolgatan", "Torggatan", "Kungsgatan", "Drottninggatan" },
			"SE", "SEK", "Stockholm", "+46"
		),
		["FI"] = (
			new[] { "Mikko", "Aino", "Juhani", "Helmi", "Matti", "Kerttu", "Eero", "Liisa", "Antti", "Saara" },
			new[] { "Virtanen", "Korhonen", "Mäkinen", "Nieminen", "Hämäläinen", "Laine", "Heikkinen", "Koskinen", "Järvinen", "Lehtonen" },
			new[] { "Helsinki", "Espoo", "Tampere", "Vantaa", "Oulu", "Turku", "Jyväskylä", "Lahti", "Kuopio", "Pori" },
			new[] { "Mannerheimintie", "Hämeentie", "Aleksanterinkatu", "Mikonkatu", "Kalevankatu", "Bulevardi", "Esplanadi", "Senaatintori" },
			"FI", "EUR", "Uusimaa", "+358"
		)
	};

	private IEnumerable<Order> FilteredOrders =>
		string.IsNullOrWhiteSpace(searchOrderNo)
			? orders
			: orders.Where(o => o.OrderNo.ToString().Contains(searchOrderNo, StringComparison.OrdinalIgnoreCase));

	protected override async Task OnInitializedAsync()
	{
		await LoadOrders();

		// Setup timer to refresh orders every 0.5 seconds
		refreshTimer = new Timer(async _ =>
		{
			await InvokeAsync(async () =>
			{
				await LoadOrders();
				StateHasChanged();
			});
		}, null, TimeSpan.FromSeconds(2), TimeSpan.FromSeconds(2));
	}

	private async Task LoadOrders()
	{
		isLoading = true;
		try
		{
			var client = HttpClientFactory.CreateClient("ERPApi");
			var response = await client.GetAsync("/api/order");

			if (response.IsSuccessStatusCode)
			{
				var json = await response.Content.ReadAsStringAsync();
				var result = JsonSerializer.Deserialize<List<Order>>(json, new JsonSerializerOptions
				{
					PropertyNameCaseInsensitive = true
				});

				if (result != null)
				{
					orders = result;
				}
			}
		}
		catch (Exception ex)
		{
			Console.WriteLine($"Error loading orders: {ex.Message}");
		}
		finally
		{
			isLoading = false;
		}
	}

	private void ClearFilter()
	{
		searchOrderNo = "";
	}

	private async Task OpenOrderDetails(Order order)
	{
		selectedOrder = order;
		showOrderModal = true;
		isLoadingOrderLogs = true;
		orderLogs = new List<SeqEvent>();

		try
		{
			// Fetch logs by OrderId - this traces the order across all services
			var result = await SeqLogService.GetLogsByOrderIdAsync(order.Id.ToString(), 100);
			orderLogs = result.Events.OrderBy(l => l.Timestamp).ToList();
		}
		catch (Exception ex)
		{
			Console.WriteLine($"Error loading order logs: {ex.Message}");
			orderLogs = new List<SeqEvent>();
		}
		finally
		{
			isLoadingOrderLogs = false;
			StateHasChanged();
		}
	}

	private void CloseOrderModal()
	{
		showOrderModal = false;
		selectedOrder = null;
		orderLogs = new List<SeqEvent>();
	}

	private void GenerateRandomOrder()
	{
		var order = CreateOrderForCountry("DK", fashionProducts);
		orderJson = JsonSerializer.Serialize(order, new JsonSerializerOptions { WriteIndented = true });
		validationError = "";
		responseMessage = "";
	}

	private async Task Generate5CountryOrders()
	{
		isSubmitting = true;
		responseMessage = "";
		validationError = "";

		try
		{
			var countries = new[] { "DK", "DE", "NO", "SE", "FI" };
			var submittedOrders = new List<string>();

			foreach (var countryCode in countries)
			{
				var order = CreateOrderForCountry(countryCode, fashionProducts);
				var json = JsonSerializer.Serialize(order, new JsonSerializerOptions { WriteIndented = true });

				var content = new StringContent(json, Encoding.UTF8, "application/json");
				var response = await Http.PostAsync("api/order", content);

				if (response.IsSuccessStatusCode)
				{
					var result = await response.Content.ReadAsStringAsync();
					var jsonResult = JsonDocument.Parse(result);

					if (jsonResult.RootElement.TryGetProperty("orderNo", out var orderNoElement))
					{
						submittedOrders.Add($"{countryCode}: #{orderNoElement.GetInt32()}");
					}
				}

				// Small delay to avoid overwhelming the system
				await Task.Delay(200);
			}

			if (submittedOrders.Count == 5)
			{
				isSuccess = true;
				responseMessage = $"5 orders submitted! {string.Join(", ", submittedOrders)}";
				await LoadOrders();
			}
			else
			{
				responseMessage = $"Only {submittedOrders.Count}/5 orders submitted successfully";
				isSuccess = false;
			}
		}
		catch (Exception ex)
		{
			responseMessage = $"Error: {ex.Message}";
			isSuccess = false;
		}
		finally
		{
			isSubmitting = false;
		}
	}

	private Order CreateOrderForCountry(string countryCode, (string sku, string name, decimal price)[] productCatalog)
	{
		var data = countryData[countryCode];
		var orderId = Guid.NewGuid();
		var customerId = Guid.NewGuid();

		// Generate 2-4 random items
		var itemCount = random.Next(2, 5);
		var orderItems = new List<OrderItem>();
		decimal totalAmount = 0;

		for (int i = 0; i < itemCount; i++)
		{
			var product = productCatalog[random.Next(productCatalog.Length)];
			var quantity = random.Next(1, 3);
			var totalPrice = product.price * quantity;
			totalAmount += totalPrice;

			orderItems.Add(new OrderItem
			{
				Id = Guid.NewGuid(),
				OrderId = orderId,
				Sku = product.sku,
				Name = product.name,
				Quantity = quantity,
				UnitPrice = product.price,
				TotalPrice = totalPrice,
				Status = "Pending"
			});
		}

		var firstName = data.firstNames[random.Next(data.firstNames.Length)];
		var lastName = data.lastNames[random.Next(data.lastNames.Length)];
		var city = data.cities[random.Next(data.cities.Length)];
		var street = data.streets[random.Next(data.streets.Length)] + " " + random.Next(1, 200);
		var emailDomain = countryCode.ToLower();

		return new Order
		{
			Id = orderId,
			OrderNo = 0,
			CreatedAt = DateTime.UtcNow,
			OrderState = "Pending",
			CountryCode = countryCode,
			TotalAmount = totalAmount,
			CustomerId = customerId,
			OrderItems = orderItems,
			Customer = new Customer
			{
				Id = customerId,
				FirstName = firstName,
				LastName = lastName,
				Email = $"{firstName.ToLower()}.{lastName.ToLower()}@example.{emailDomain}",
				Phone = $"{data.phonePrefix}-{random.Next(20, 99)}-{random.Next(10, 99)}-{random.Next(10, 99)}-{random.Next(10, 99)}"
			},
			Payment = new Payment
			{
				PaymentMethod = random.Next(3) switch { 0 => "Credit Card", 1 => "Debit Card", _ => "Bank Transfer" },
				PaymentStatus = "Authorized",
				PaidAt = DateTime.UtcNow,
				Currency = data.currency,
				Amount = totalAmount
			},
			ShippingAddress = new Address
			{
				Street = street,
				City = city,
				State = data.state,
				PostalCode = random.Next(1000, 9999).ToString(),
				Country = countryCode
			}
		};
	}

	private void ClearEditor()
	{
		orderJson = "";
		validationError = "";
		responseMessage = "";
		orderNo = "";
		isSuccess = false;
	}

	private async Task SubmitOrder()
	{
		validationError = "";
		responseMessage = "";
		isSubmitting = true;
		isSuccess = false;

		try
		{
			if (string.IsNullOrWhiteSpace(orderJson))
			{
				validationError = "Order JSON cannot be empty";
				return;
			}

			JsonDocument.Parse(orderJson);

			var content = new StringContent(orderJson, Encoding.UTF8, "application/json");
			var response = await Http.PostAsync("api/order", content);

			if (response.IsSuccessStatusCode)
			{
				var result = await response.Content.ReadAsStringAsync();
				var jsonResult = JsonDocument.Parse(result);

				if (jsonResult.RootElement.TryGetProperty("orderNo", out var orderNoElement))
				{
					orderNo = orderNoElement.GetInt32().ToString();
					isSuccess = true;
					responseMessage = "Order submitted successfully!";

					// Refresh order list
					await LoadOrders();
				}
			}
			else
			{
				var errorContent = await response.Content.ReadAsStringAsync();
				responseMessage = $"HTTP {(int)response.StatusCode}: {errorContent}";
				isSuccess = false;
			}
		}
		catch (JsonException ex)
		{
			validationError = $"Invalid JSON: {ex.Message}";
		}
		catch (Exception ex)
		{
			responseMessage = $"Error: {ex.Message}";
			isSuccess = false;
		}
		finally
		{
			isSubmitting = false;
		}
	}

	private string GetStatusBadgeClass(string status) => status switch
	{
		"Created" => "inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-blue-100 text-blue-800",
		"StockReserved" or "PartialDelivered" => "inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",
		"Picked" => "inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-purple-100 text-purple-800",
		"Packed" => "inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-green-100 text-green-800",
		"StockUnavailable" => "inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-red-100 text-red-800",
		_ => "inline-flex px-2 py-0.5 text-xs font-medium rounded-full bg-gray-100 text-gray-800"
	};

	private string GetLogLevelBadgeClass(string level) => level switch
	{
		"Information" => "inline-flex px-2 py-0.5 text-xs font-medium rounded bg-blue-100 text-blue-800",
		"Warning" => "inline-flex px-2 py-0.5 text-xs font-medium rounded bg-yellow-100 text-yellow-800",
		"Error" => "inline-flex px-2 py-0.5 text-xs font-medium rounded bg-red-100 text-red-800",
		"Fatal" => "inline-flex px-2 py-0.5 text-xs font-medium rounded bg-red-200 text-red-900",
		"Debug" => "inline-flex px-2 py-0.5 text-xs font-medium rounded bg-gray-100 text-gray-700",
		_ => "inline-flex px-2 py-0.5 text-xs font-medium rounded bg-gray-100 text-gray-800"
	};

	private string GetLogBackgroundClass(string level) => level switch
	{
		"Error" => "bg-red-50",
		"Fatal" => "bg-red-100",
		"Warning" => "bg-yellow-50",
		_ => ""
	};

	public void Dispose()
	{
		refreshTimer?.Dispose();
	}
}


================================================
FILE: BlazorUI/Pages/Weather.razor
================================================
﻿@page "/weather"
@inject HttpClient Http

<PageTitle>Weather</PageTitle>

<h1>Weather</h1>

<p>This component demonstrates fetching data from the server.</p>

@if (forecasts == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <table class="table">
        <thead>
            <tr>
                <th>Date</th>
                <th aria-label="Temperature in Celsius">Temp. (C)</th>
                <th aria-label="Temperature in Farenheit">Temp. (F)</th>
                <th>Summary</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var forecast in forecasts)
            {
                <tr>
                    <td>@forecast.Date.ToShortDateString()</td>
                    <td>@forecast.TemperatureC</td>
                    <td>@forecast.TemperatureF</td>
                    <td>@forecast.Summary</td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private WeatherForecast[]? forecasts;

    protected override async Task OnInitializedAsync()
    {
        forecasts = await Http.GetFromJsonAsync<WeatherForecast[]>("sample-data/weather.json");
    }

    public class WeatherForecast
    {
        public DateOnly Date { get; set; }

        public int TemperatureC { get; set; }

        public string? Summary { get; set; }

        public int TemperatureF => 32 + (int)(TemperatureC / 0.5556);
    }
}



================================================
FILE: BlazorUI/Properties/launchSettings.json
================================================
{
  "$schema": "https://json.schemastore.org/launchsettings.json",
  "profiles": {
    "http": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": true,
      "inspectUri": "{wsProtocol}://{url.hostname}:{url.port}/_framework/debug/ws-proxy?browser={browserInspectUri}",
      "applicationUrl": "http://localhost:5035",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    },
    "https": {
      "commandName": "Project",
      "dotnetRunMessages": true,
      "launchBrowser": true,
      "inspectUri": "{wsProtocol}://{url.hostname}:{url.port}/_framework/debug/ws-proxy?browser={browserInspectUri}",
      "applicationUrl": "https://localhost:7103;http://localhost:5035",
      "environmentVariables": {
        "ASPNETCORE_ENVIRONMENT": "Development"
      }
    }
  }
}



================================================
FILE: BlazorUI/Services/SeqLogService.cs
================================================
using System.Text.Json;
using System.Text.Json.Serialization;

namespace BlazorUI.Services;

public class SeqLogService
{
    private readonly HttpClient _httpClient;

    public SeqLogService(HttpClient httpClient)
    {
        _httpClient = httpClient;
        // Use ERPApi as proxy to avoid CORS issues with Seq
        _httpClient.BaseAddress = new Uri("https://localhost:7033");
    }

    public async Task<SeqEventResponse> GetLogsByOrderIdAsync(string orderId, int count = 50)
    {
        try
        {
            // Call ERPApi proxy endpoint to avoid CORS issues
            var response = await _httpClient.GetAsync($"/api/logs/by-orderid/{orderId}?count={count}");

            if (!response.IsSuccessStatusCode)
                return new SeqEventResponse();

            var json = await response.Content.ReadAsStringAsync();

            // ERPApi proxy returns array directly
            var events = JsonSerializer.Deserialize<List<SeqEvent>>(json, new JsonSerializerOptions
            {
                PropertyNameCaseInsensitive = true
            });

            return new SeqEventResponse { Events = events ?? new List<SeqEvent>() };
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error in GetLogsByOrderIdAsync: {ex.Message}");
            return new SeqEventResponse();
        }
    }
}

public class SeqEventResponse
{
    [JsonPropertyName("Events")]
    public List<SeqEvent> Events { get; set; } = new();
}

public class SeqEvent
{
    [JsonPropertyName("Timestamp")]
    public DateTime Timestamp { get; set; }

    [JsonPropertyName("Level")]
    public string Level { get; set; } = string.Empty;

    [JsonPropertyName("MessageTemplate")]
    public string MessageTemplate { get; set; } = string.Empty;

    [JsonPropertyName("RenderedMessage")]
    public string RenderedMessage { get; set; } = string.Empty;

    // Seq returns Properties as an array of {Name, Value} objects
    [JsonPropertyName("Properties")]
    public List<SeqProperty> Properties { get; set; } = new();

    // MessageTemplateTokens for building the rendered message
    [JsonPropertyName("MessageTemplateTokens")]
    public List<MessageTemplateToken> MessageTemplateTokens { get; set; } = new();

    public string GetProperty(string key)
    {
        var prop = Properties.FirstOrDefault(p => p.Name == key);
        if (prop != null && prop.Value != null)
        {
            // Handle JsonElement from Value property
            if (prop.Value is JsonElement jsonElement)
            {
                return jsonElement.ValueKind == JsonValueKind.String
                    ? jsonElement.GetString() ?? string.Empty
                    : jsonElement.ToString();
            }
            return prop.Value.ToString() ?? string.Empty;
        }
        return string.Empty;
    }

    public string GetRenderedMessage()
    {
        if (!string.IsNullOrEmpty(RenderedMessage))
            return RenderedMessage;

        // Build message from MessageTemplateTokens if available
        if (MessageTemplateTokens != null && MessageTemplateTokens.Count > 0)
        {
            var messageBuilder = new System.Text.StringBuilder();

            foreach (var token in MessageTemplateTokens)
            {
                if (!string.IsNullOrEmpty(token.Text))
                {
                    // This is a literal text token
                    messageBuilder.Append(token.Text);
                }
                else if (!string.IsNullOrEmpty(token.PropertyName))
                {
                    // This is a property placeholder - get the value from Properties
                    var prop = Properties.FirstOrDefault(p => p.Name == token.PropertyName);
                    if (prop != null && prop.Value != null)
                    {
                        var valueStr = prop.Value is JsonElement jsonElement
                            ? (jsonElement.ValueKind == JsonValueKind.String ? jsonElement.GetString() : jsonElement.ToString())
                            : prop.Value.ToString();
                        messageBuilder.Append(valueStr ?? "");
                    }
                    else
                    {
                        // Fallback to placeholder if property not found
                        messageBuilder.Append($"{{{token.PropertyName}}}");
                    }
                }
            }

            return messageBuilder.ToString();
        }

        // Fallback: Build message from MessageTemplate
        var message = MessageTemplate;
        foreach (var prop in Properties)
        {
            if (prop.Value != null)
            {
                var valueStr = prop.Value is JsonElement jsonElement
                    ? (jsonElement.ValueKind == JsonValueKind.String ? jsonElement.GetString() : jsonElement.ToString())
                    : prop.Value.ToString();

                message = message.Replace($"{{{prop.Name}}}", valueStr ?? "");
            }
        }
        return message;
    }

    public List<SeqProperty> GetRelevantProperties()
    {
        // Filter out common/noisy properties
        var excludedProps = new HashSet<string>
        {
            "Environment", "MachineName", "ThreadId", "Service", "SourceContext",
            "ActionId", "ActionName", "ConnectionId", "RequestId", "Scope", "EventId"
        };

        return Properties.Where(p => !excludedProps.Contains(p.Name)).ToList();
    }
}

public class SeqProperty
{
    [JsonPropertyName("Name")]
    public string Name { get; set; } = string.Empty;

    [JsonPropertyName("Value")]
    public object? Value { get; set; }
}

public class MessageTemplateToken
{
    [JsonPropertyName("Text")]
    public string? Text { get; set; }

    [JsonPropertyName("PropertyName")]
    public string? PropertyName { get; set; }
}



================================================
FILE: BlazorUI/wwwroot/index.html
================================================
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StreamFlow WMS - Dashboard</title>
    <base href="/" />
    
    <!-- TailwindCSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js CDN -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <link rel="stylesheet" href="css/app.css" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="BlazorUI.styles.css" rel="stylesheet" />
    
    <style>
        /* HyperUI-inspired Gray/White Theme (No Shadows) */
        body {
            background-color: #f9fafb;
        }
    </style>
</head>

<body>
    <div id="app">
        <div class="flex items-center justify-center h-screen bg-gray-50">
            <div class="text-center">
                <div class="inline-block animate-spin rounded-full h-16 w-16 border-4 border-gray-900 border-t-transparent"></div>
                <p class="mt-4 text-gray-600 font-medium">Loading StreamFlow WMS...</p>
            </div>
        </div>
    </div>

    <div id="blazor-error-ui" class="fixed bottom-0 left-0 right-0 bg-red-100 border-t-2 border-red-800 text-red-800 px-4 py-3 text-sm">
        An unhandled error has occurred.
        <a href="." class="underline font-medium">Reload</a>
        <button class="float-right font-bold" onclick="document.getElementById('blazor-error-ui').style.display='none'">✕</button>
    </div>
    
    <script src="_framework/blazor.webassembly.js"></script>
</body>

</html>



================================================
FILE: BlazorUI/wwwroot/css/app.css
================================================
html, body {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
}

h1:focus {
    outline: none;
}

a, .btn-link {
    color: #0071c1;
}

.btn-primary {
    color: #fff;
    background-color: #1b6ec2;
    border-color: #1861ac;
}

.btn:focus, .btn:active:focus, .btn-link.nav-link:focus, .form-control:focus, .form-check-input:focus {
  box-shadow: 0 0 0 0.1rem white, 0 0 0 0.25rem #258cfb;
}

.content {
    padding-top: 1.1rem;
}

.valid.modified:not([type=checkbox]) {
    outline: 1px solid #26b050;
}

.invalid {
    outline: 1px solid red;
}

.validation-message {
    color: red;
}

#blazor-error-ui {
    color-scheme: light only;
    background: lightyellow;
    bottom: 0;
    box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.2);
    box-sizing: border-box;
    display: none;
    left: 0;
    padding: 0.6rem 1.25rem 0.7rem 1.25rem;
    position: fixed;
    width: 100%;
    z-index: 1000;
}

    #blazor-error-ui .dismiss {
        cursor: pointer;
        position: absolute;
        right: 0.75rem;
        top: 0.5rem;
    }

.blazor-error-boundary {
    background: url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTYiIGhlaWdodD0iNDkiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIG92ZXJmbG93PSJoaWRkZW4iPjxkZWZzPjxjbGlwUGF0aCBpZD0iY2xpcDAiPjxyZWN0IHg9IjIzNSIgeT0iNTEiIHdpZHRoPSI1NiIgaGVpZ2h0PSI0OSIvPjwvY2xpcFBhdGg+PC9kZWZzPjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yMzUgLTUxKSI+PHBhdGggZD0iTTI2My41MDYgNTFDMjY0LjcxNyA1MSAyNjUuODEzIDUxLjQ4MzcgMjY2LjYwNiA1Mi4yNjU4TDI2Ny4wNTIgNTIuNzk4NyAyNjcuNTM5IDUzLjYyODMgMjkwLjE4NSA5Mi4xODMxIDI5MC41NDUgOTIuNzk1IDI5MC42NTYgOTIuOTk2QzI5MC44NzcgOTMuNTEzIDI5MSA5NC4wODE1IDI5MSA5NC42NzgyIDI5MSA5Ny4wNjUxIDI4OS4wMzggOTkgMjg2LjYxNyA5OUwyNDAuMzgzIDk5QzIzNy45NjMgOTkgMjM2IDk3LjA2NTEgMjM2IDk0LjY3ODIgMjM2IDk0LjM3OTkgMjM2LjAzMSA5NC4wODg2IDIzNi4wODkgOTMuODA3MkwyMzYuMzM4IDkzLjAxNjIgMjM2Ljg1OCA5Mi4xMzE0IDI1OS40NzMgNTMuNjI5NCAyNTkuOTYxIDUyLjc5ODUgMjYwLjQwNyA1Mi4yNjU4QzI2MS4yIDUxLjQ4MzcgMjYyLjI5NiA1MSAyNjMuNTA2IDUxWk0yNjMuNTg2IDY2LjAxODNDMjYwLjczNyA2Ni4wMTgzIDI1OS4zMTMgNjcuMTI0NSAyNTkuMzEzIDY5LjMzNyAyNTkuMzEzIDY5LjYxMDIgMjU5LjMzMiA2OS44NjA4IDI1OS4zNzEgNzAuMDg4N0wyNjEuNzk1IDg0LjAxNjEgMjY1LjM4IDg0LjAxNjEgMjY3LjgyMSA2OS43NDc1QzI2Ny44NiA2OS43MzA5IDI2Ny44NzkgNjkuNTg3NyAyNjcuODc5IDY5LjMxNzkgMjY3Ljg3OSA2Ny4xMTgyIDI2Ni40NDggNjYuMDE4MyAyNjMuNTg2IDY2LjAxODNaTTI2My41NzYgODYuMDU0N0MyNjEuMDQ5IDg2LjA1NDcgMjU5Ljc4NiA4Ny4zMDA1IDI1OS43ODYgODkuNzkyMSAyNTkuNzg2IDkyLjI4MzcgMjYxLjA0OSA5My41Mjk1IDI2My41NzYgOTMuNTI5NSAyNjYuMTE2IDkzLjUyOTUgMjY3LjM4NyA5Mi4yODM3IDI2Ny4zODcgODkuNzkyMSAyNjcuMzg3IDg3LjMwMDUgMjY2LjExNiA4Ni4wNTQ3IDI2My41NzYgODYuMDU0N1oiIGZpbGw9IiNGRkU1MDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvZz48L3N2Zz4=) no-repeat 1rem/1.8rem, #b32121;
    padding: 1rem 1rem 1rem 3.7rem;
    color: white;
}

    .blazor-error-boundary::after {
        content: "An error has occurred."
    }

.loading-progress {
    position: relative;
    display: block;
    width: 8rem;
    height: 8rem;
    margin: 20vh auto 1rem auto;
}

    .loading-progress circle {
        fill: none;
        stroke: #e0e0e0;
        stroke-width: 0.6rem;
        transform-origin: 50% 50%;
        transform: rotate(-90deg);
    }

        .loading-progress circle:last-child {
            stroke: #1b6ec2;
            stroke-dasharray: calc(3.141 * var(--blazor-load-percentage, 0%) * 0.8), 500%;
            transition: stroke-dasharray 0.05s ease-in-out;
        }

.loading-progress-text {
    position: absolute;
    text-align: center;
    font-weight: bold;
    inset: calc(20vh + 3.25rem) 0 auto 0.2rem;
}

    .loading-progress-text:after {
        content: var(--blazor-load-percentage-text, "Loading");
    }

code {
    color: #c02d76;
}

.form-floating > .form-control-plaintext::placeholder, .form-floating > .form-control::placeholder {
    color: var(--bs-secondary-color);
    text-align: end;
}

.form-floating > .form-control-plaintext:focus::placeholder, .form-floating > .form-control:focus::placeholder {
    text-align: start;
}


================================================
FILE: BlazorUI/wwwroot/sample-data/weather.json
================================================
﻿[
  {
    "date": "2022-01-06",
    "temperatureC": 1,
    "summary": "Freezing"
  },
  {
    "date": "2022-01-07",
    "temperatureC": 14,
    "summary": "Bracing"
  },
  {
    "date": "2022-01-08",
    "temperatureC": -13,
    "summary": "Freezing"
  },
  {
    "date": "2022-01-09",
    "temperatureC": -16,
    "summary": "Balmy"
  },
  {
    "date": "2022-01-10",
    "temperatureC": -2,
    "summary": "Chilly"
  }
]



================================================
FILE: Contracts/Contracts.csproj
================================================
﻿<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\Entities\Entities.csproj" />
  </ItemGroup>

  <!-- No project reference to Entities to avoid leaking domain models across boundaries -->

</Project>



================================================
FILE: Contracts/CreateOrderRequest.cs
================================================
﻿using Entities.Model;

namespace Contracts
{
    public record CreateOrderRequest
    {
        public required Order Order { get; set; }
        public Guid? CorrelationId { get; set; }
    }
}



================================================
FILE: Contracts/CreateOrderResponse.cs
================================================
﻿namespace Contracts
{
    public record CreateOrderResponse
    {
        public int OrderNo { get; set; }
        public bool IsSuccessfullyCreated { get; set; }
        public string ErrorMessage { get; set; }
    }
}



================================================
FILE: Contracts/Dtos/CustomerDto.cs
================================================
namespace Contracts.Dtos
{
    public record CustomerDto
    {
        public Guid CustomerId { get; init; }
        public string Name { get; init; } = string.Empty;
        public string Email { get; init; } = string.Empty;
        public string CustomerType { get; init; } = "Regular"; // "Premium" | "Regular"
    }
}



================================================
FILE: Contracts/Dtos/OrderItemDto.cs
================================================
namespace Contracts.Dtos
{
    public record OrderItemDto
    {
        public string Sku { get; init; } = string.Empty;
        public int Quantity { get; init; }
        public string ProductName { get; init; } = string.Empty;
        public decimal UnitPrice { get; init; }
    }
}



================================================
FILE: Contracts/Dtos/OrderTrackingResponse.cs
================================================
namespace Contracts.DTOs
{
    public class OrderTrackingResponse
    {
        public Guid OrderId { get; set; }
        public string OrderNo { get; set; } = string.Empty;
        public string CurrentState { get; set; } = string.Empty;
        public string StatusMessage { get; set; } = string.Empty;
        public Guid? CorrelationId { get; set; }
        public DateTime CreatedAt { get; set; }
        public DateTime? LastUpdatedAt { get; set; }
        public string OrderType { get; set; } = string.Empty;
        public decimal TotalAmount { get; set; }
        
        // Additional tracking info
        public List<OrderStatusHistoryItem> StatusHistory { get; set; } = new();
    }

    public class OrderStatusHistoryItem
    {
        public string State { get; set; } = string.Empty;
        public string StatusMessage { get; set; } = string.Empty;
        public DateTime Timestamp { get; set; }
    }
}



================================================
FILE: Contracts/Dtos/ShippingAddressDto.cs
================================================
namespace Contracts.Dtos
{
    public record ShippingAddressDto
    {
        public string Street { get; init; } = string.Empty;
        public string City { get; init; } = string.Empty;
        public string PostalCode { get; init; } = string.Empty;
        public string State { get; init; } = string.Empty;
        public string Country { get; init; } = string.Empty;
    }
}



================================================
FILE: Contracts/Events/OrderCreated.cs
================================================
using Contracts.Dtos;

namespace Contracts.Events
{
    /// <summary>
    /// Published when an order is created in ERPApi.
    /// Contains enriched data (Content Enricher pattern) to avoid downstream HTTP calls.
    /// </summary>
    public record OrderCreated
    {
        // Core identifiers
        public Guid OrderId { get; init; }
        public int OrderNo { get; init; }
        public string OrderType { get; init; } = string.Empty; // "Priority" | "Standard"
        public byte Priority { get; init; } // 9 for Priority (DK), 1 for Standard
        
        // Enriched: Order items for inventory check
        public List<OrderItemDto> Items { get; init; } = new();
        
        // Enriched: Customer context
        public CustomerDto Customer { get; init; } = null!;
        
        // Enriched: Shipping context
        public ShippingAddressDto ShippingAddress { get; init; } = null!;
        
        // Enriched: Order summary
        public decimal TotalAmount { get; init; }
        public int TotalItems { get; init; }
        
        // Tracing
        public string CorrelationId { get; init; } = Guid.NewGuid().ToString();
        public DateTime CreatedAt { get; init; } = DateTime.UtcNow;
    }
}



================================================
FILE: Contracts/Events/OrderInvalid.cs
================================================
namespace Contracts.Events
{
    /// <summary>
    /// Event published when an order fails validation.
    /// Sent to erp-invalid-order queue for manual review.
    /// </summary>
    public class OrderInvalid
    {
        public Guid OrderId { get; set; }
        public Guid CorrelationId { get; set; }
        public DateTime InvalidatedAt { get; set; }
        public string Reason { get; set; } = string.Empty;
        public List<string> ValidationErrors { get; set; } = new();
        public string OrderJson { get; set; } = string.Empty; // Store original order for review
    }
}



================================================
FILE: Contracts/Events/OrderPacked.cs
================================================
using Contracts.Dtos;

namespace Contracts.Events
{
    /// <summary>
    /// Published by PackingService when an order has been packed.
    /// This is the final event in the order processing flow.
    /// </summary>
    public record OrderPacked
    {
        public Guid OrderId { get; init; }
        public string CorrelationId { get; init; } = string.Empty;
        public DateTime PackedAt { get; init; } = DateTime.UtcNow;
        public string PackedBy { get; init; } = "System"; // Could be worker ID
        public decimal TotalWeight { get; init; } // For shipping
        public string BoxSize { get; init; } = "Standard"; // "Small" | "Standard" | "Large"
        
        // Enriched data (minimal - mainly for tracking/logging)
        public List<OrderItemDto> Items { get; init; } = new();
        public ShippingAddressDto ShippingAddress { get; init; } = new();
    }
}



================================================
FILE: Contracts/Events/OrderPicked.cs
================================================
using Contracts.Dtos;

namespace Contracts.Events
{
    /// <summary>
    /// Published by PickingService when an order has been picked.
    /// Enriched with all data needed for downstream processing (Content Enricher pattern).
    /// </summary>
    public record OrderPicked
    {
        public Guid OrderId { get; init; }
        public string OrderType { get; init; } = string.Empty;
        public string CorrelationId { get; init; } = string.Empty;
        public DateTime PickedAt { get; init; } = DateTime.UtcNow;
        public string PickedBy { get; init; } = "System"; // Could be worker ID
        
        // Enriched data for downstream consumers (no HTTP calls needed)
        public List<OrderItemDto> Items { get; init; } = new();
        public CustomerDto Customer { get; init; } = new();
        public ShippingAddressDto ShippingAddress { get; init; } = new();
    }
}



================================================
FILE: Contracts/Events/StockReserved.cs
================================================
using Contracts.Dtos;

namespace Contracts.Events
{
    /// <summary>
    /// Published by InventoryApi when stock is successfully reserved for an order.
    /// Enriched with all data needed for downstream processing (Content Enricher pattern).
    /// Handles both full and partial stock reservations via IsPartialReservation flag.
    /// </summary>
    public record StockReserved
    {
        public Guid OrderId { get; init; }
        public string OrderType { get; init; } = string.Empty;
        public string CorrelationId { get; init; } = string.Empty;
        public DateTime ReservedAt { get; init; } = DateTime.UtcNow;
        
        // Partial reservation support
        public bool IsPartialReservation { get; init; }
        public int TotalRequested { get; init; }
        public int TotalReserved { get; init; }
        
        // Enriched data for downstream consumers (no HTTP calls needed)
        public List<OrderItemDto> Items { get; init; } = new();
        public CustomerDto Customer { get; init; } = new();
        public ShippingAddressDto ShippingAddress { get; init; } = new();
    }
}



================================================
FILE: Contracts/Events/StockUnavailable.cs
================================================
namespace Contracts.Events
{
    /// <summary>
    /// Published by InventoryApi when stock cannot be reserved for an order.
    /// This is a terminal state - order cannot proceed to picking.
    /// </summary>
    public record StockUnavailable
    {
        public Guid OrderId { get; init; }
        public string CorrelationId { get; init; } = string.Empty;
        public List<string> UnavailableSkus { get; init; } = new();
        public string Reason { get; init; } = string.Empty;
        public DateTime CheckedAt { get; init; } = DateTime.UtcNow;
    }
}



================================================
FILE: Entities/Entities.csproj
================================================
﻿<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>



================================================
FILE: Entities/Model/Address.cs
================================================
﻿namespace Entities.Model
{
    public class Address
    {
        public string Street { get; set; }
        public string City { get; set; }
        public string State { get; set; }
        public string PostalCode { get; set; }
        public string Country { get; set; }
    }
}



================================================
FILE: Entities/Model/Customer.cs
================================================
﻿namespace Entities.Model
{
    public class Customer
    {
        public Guid Id { get; set; }
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string Email { get; set; }
        public string Phone { get; set; }
    }
}



================================================
FILE: Entities/Model/Order.cs
================================================
﻿using System.ComponentModel.DataAnnotations;
using System.Security.Cryptography;

namespace Entities.Model
{
    public class Order
    {
        public Guid Id { get; set; }
        public int OrderNo { get; set; }
        public DateTime CreatedAt { get; set; }
        public string OrderState { get; set; } = "Pending";
        public string CountryCode { get; set; } = string.Empty;
        public decimal TotalAmount { get; set; }
        public Guid CustomerId { get; set; }
        public string CorrelationId { get; set; } = Guid.NewGuid().ToString();
        
        [Timestamp]
        public byte[]? RowVersion { get; set; }
        
        public List<OrderItem> OrderItems { get; set; } = new List<OrderItem>();
        public Customer Customer { get; set; } = null!;
        public Payment Payment { get; set; } = null!;
        public Address ShippingAddress { get; set; } = null!;

        /// <summary>
        /// Determines order type based on shipping country.
        /// DK (Denmark) orders are Priority, all others are Standard.
        /// </summary>
        public string FindOrderType()
        {
            return ShippingAddress?.Country?.Trim().Equals("DK", StringComparison.OrdinalIgnoreCase) == true
                ? "Priority"
                : "Standard";
        }

        /// <summary>
        /// Gets the priority level for RabbitMQ priority queue.
        /// Priority orders (DK) = 9, Standard = 1
        /// </summary>
        public byte GetPriority()
        {
            return FindOrderType() == "Priority" ? (byte)9 : (byte)1;
        }
    }
}



================================================
FILE: Entities/Model/OrderItem.cs
================================================
﻿namespace Entities.Model
{
    public class OrderItem
    {
        public Guid Id { get; set; }
        public Guid OrderId { get; set; }
        public string? Sku { get; set; }
        public string? Name { get; set; }
        public int Quantity { get; set; }
        public decimal UnitPrice { get; set; }
        public decimal TotalPrice { get; set; }
        
        /// <summary>
        /// Tracks the fulfillment status of this order item.
        /// Possible values: Pending, Available, Unavailable, Picked, Packed
        /// </summary>
        public string Status { get; set; } = "Pending";
    }
}



================================================
FILE: Entities/Model/Payment.cs
================================================
﻿namespace Entities.Model
{
    public class Payment
    {
        public string PaymentMethod { get; set; }
        public string PaymentStatus { get; set; }
        public DateTime? PaidAt { get; set; }
        public string Currency { get; set; }
        public decimal Amount { get; set; }
    }
}



================================================
FILE: Entities/Model/Stock.cs
================================================
﻿namespace Entities.Model
{
    public class Stock
    {
        public Guid Id { get; set; }
        public required string Sku { get; set; }
        
        // Total quantity in stock (physical inventory)
        public int TotalQuantity { get; set; }
        
        // Quantity reserved for orders (not yet picked)
        public int ReservedQuantity { get; set; }
        
        // Available quantity (TotalQuantity - ReservedQuantity)
        public int AvailableQuantity => TotalQuantity - ReservedQuantity;
        
        public DateTime LastUpdated { get; set; }
    }
}



================================================
FILE: ERPApi/appsettings.Development.json
================================================
{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  }
}



================================================
FILE: ERPApi/appsettings.json
================================================
{
  "RabbitMQSettings": {
    "Host": "localhost",
    "Port": "/",
    "Username": "guest",
    "Password": "guest"
  },
  "ConnectionStrings": {
    "DefaultConnection": "Data Source=erp.db"
  },
  "Seq": {
    "BaseUrl": "http://localhost:5341",
    "ApiKey": "StreamFlowXApiKey"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },
  "AllowedHosts": "*"
}



================================================
FILE: ERPApi/ERPApi.csproj
================================================
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
    <TargetFramework>net9.0</TargetFramework>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Include="AspNetCore.HealthChecks.Rabbitmq" Version="9.0.0" />
    <PackageReference Include="AspNetCore.HealthChecks.Sqlite" Version="9.0.0" />
    <PackageReference Include="FluentValidation" Version="12.0.0" />
    <PackageReference Include="MassTransit" Version="8.5.5" />
    <PackageReference Include="MassTransit.EntityFrameworkCore" Version="8.5.5" />
    <PackageReference Include="MassTransit.RabbitMQ" Version="8.5.4" />
    <PackageReference Include="Microsoft.AspNetCore.OpenApi" Version="9.0.10" />
    <PackageReference Include="Microsoft.EntityFrameworkCore.Design" Version="9.0.10">
      <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
      <PrivateAssets>all</PrivateAssets>
    </PackageReference>
    <PackageReference Include="Microsoft.EntityFrameworkCore.Sqlite" Version="9.0.10" />
    <PackageReference Include="HotChocolate.AspNetCore" Version="14.0.0" />
    <PackageReference Include="HotChocolate.Types.Scalars" Version="14.0.0" />
    <PackageReference Include="Microsoft.Extensions.Diagnostics.HealthChecks.EntityFrameworkCore" Version="9.0.9" />
    <PackageReference Include="Npgsql.EntityFrameworkCore.PostgreSQL" Version="9.0.0" />
    <PackageReference Include="Scalar.AspNetCore">
      <Version>2.8.11</Version>
    </PackageReference>
    <PackageReference Include="Serilog.AspNetCore" Version="9.0.0" />
    <PackageReference Include="Serilog.Enrichers.CorrelationId" Version="3.0.1" />
    <PackageReference Include="Serilog.Enrichers.Environment" Version="3.0.1" />
    <PackageReference Include="Serilog.Enrichers.Thread" Version="4.0.0" />
    <PackageReference Include="Serilog.Sinks.File" Version="7.0.0" />
    <PackageReference Include="Serilog.Sinks.Seq" Version="9.0.0" />
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Include="..\Entities\Entities.csproj" />
    <ProjectReference Include="..\Contracts\Contracts.csproj" />
  </ItemGroup>

</Project>



================================================
FILE: ERPApi/Program.cs
================================================
using ERPApi.Configuration;
using ERPApi.Consumers;
using ERPApi.DBContext;
using ERPApi.Repository.Order;
using ERPApi.Services.Order;
using FluentValidation;
using MassTransit;
using Microsoft.EntityFrameworkCore;
using Scalar.AspNetCore;
using Serilog;
using Serilog.Events;

// Load configuration early to get Seq settings
var configuration = new ConfigurationBuilder()
    .SetBasePath(Directory.GetCurrentDirectory())
    .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)
    .AddJsonFile($"appsettings.{Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT") ?? "Production"}.json", optional: true)
    .Build();

// Get Seq settings - throw exception if not found
var seqBaseUrl = configuration["Seq:BaseUrl"] 
    ?? throw new InvalidOperationException("Seq:BaseUrl configuration is missing in appsettings.json");
var seqApiKey = configuration["Seq:ApiKey"] 
    ?? throw new InvalidOperationException("Seq:ApiKey configuration is missing in appsettings.json");

// Configure Serilog with professional formatting
Log.Logger = new LoggerConfiguration()
    .MinimumLevel.Information()
    .MinimumLevel.Override("Microsoft", LogEventLevel.Warning)
    .MinimumLevel.Override("Microsoft.EntityFrameworkCore", LogEventLevel.Warning)
    .Enrich.FromLogContext()
    .Enrich.WithProperty("Service", "ERPApi")
    .Enrich.WithProperty("Environment", "Development")
    .Enrich.WithMachineName()
    .Enrich.WithThreadId()
    .WriteTo.Console(outputTemplate:
        "[{Timestamp:HH:mm:ss} {Level:u3}] {SourceContext} | {Message:lj}{NewLine}{Exception}")
    .WriteTo.File(
        path: "logs/erpapi-.log",
        rollingInterval: RollingInterval.Day,
        outputTemplate: "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] [{SourceContext}] {Message:lj}{NewLine}{Exception}",
        retainedFileCountLimit: 7)
    .WriteTo.Seq(seqBaseUrl,
        apiKey: seqApiKey,
        restrictedToMinimumLevel: LogEventLevel.Information)
    .CreateLogger();

try
{
    Log.Information("Starting ERPApi with Seq configured at {SeqUrl}", seqBaseUrl);

    var builder = WebApplication.CreateBuilder(args);

    // Use Serilog for logging
    builder.Host.UseSerilog();

    builder.Services.AddControllers();
    builder.Services.AddOpenApi();

    // HttpClient for external API calls
    builder.Services.AddHttpClient();

    // Configure SeqSettings from configuration
    var seqSettings = builder.Configuration.GetSection("Seq").Get<SeqSettings>()
        ?? throw new InvalidOperationException("Seq configuration is missing in appsettings.json");
    builder.Services.AddSingleton(seqSettings);

    // CORS - Allow Blazor client
    builder.Services.AddCors(options =>
    {
        options.AddDefaultPolicy(policy =>
        {
            policy.WithOrigins("http://localhost:5035", "https://localhost:7103")
                  .AllowAnyMethod()
                  .AllowAnyHeader();
        });
    });

    // MassTransit with RabbitMQ
    var rabbitMqSettings = builder.Configuration.GetSection("RabbitMQSettings").Get<RabbitMqSettings>()
        ?? throw new InvalidOperationException("RabbitMQ configuration is missing");
    builder.Services.AddMassTransit(x =>
    {
        x.SetKebabCaseEndpointNameFormatter();

        // Register consumers
        x.AddConsumer<ERPApi.Consumers.CreateOrderRequestConsumer>();
        x.AddConsumer<ERPApi.Consumers.StockReservedConsumer>();
        x.AddConsumer<ERPApi.Consumers.StockUnavailableConsumer>();
        x.AddConsumer<ERPApi.Consumers.OrderPickedConsumer>();
        x.AddConsumer<ERPApi.Consumers.OrderPackedConsumer>();
        x.AddConsumer<ERPApi.Consumers.OrderInvalidConsumer>();

        x.AddEntityFrameworkOutbox<OrderDbContext>(o =>
        {
            o.UseSqlite();
            o.UseBusOutbox();
        });

        x.UsingRabbitMq((context, cfg) =>
        {
            cfg.Host(rabbitMqSettings.Host, rabbitMqSettings.Port, h =>
            {
                h.Username(rabbitMqSettings.Username);
                h.Password(rabbitMqSettings.Password);
            });

            cfg.Message<Contracts.Events.OrderCreated>(x => x.SetEntityName("Contracts.Events:OrderCreated"));
            cfg.Publish<Contracts.Events.OrderCreated>(x => x.ExchangeType = "topic");

            cfg.Message<Contracts.Events.OrderInvalid>(x => x.SetEntityName("Contracts.Events:OrderInvalid"));
            cfg.Publish<Contracts.Events.OrderInvalid>(x => x.ExchangeType = "topic");

            cfg.Message<Contracts.Events.StockReserved>(x => x.SetEntityName("Contracts.Events:StockReserved"));
            cfg.Publish<Contracts.Events.StockReserved>(x => x.ExchangeType = "topic");

            cfg.Message<Contracts.Events.StockUnavailable>(x => x.SetEntityName("Contracts.Events:StockUnavailable"));
            cfg.Publish<Contracts.Events.StockUnavailable>(x => x.ExchangeType = "topic");

            cfg.Message<Contracts.Events.OrderPicked>(x => x.SetEntityName("Contracts.Events:OrderPicked"));
            cfg.Publish<Contracts.Events.OrderPicked>(x => x.ExchangeType = "topic");

            cfg.Message<Contracts.Events.OrderPacked>(x => x.SetEntityName("Contracts.Events:OrderPacked"));
            cfg.Publish<Contracts.Events.OrderPacked>(x => x.ExchangeType = "topic");

            // Configure the receive endpoint for CreateOrderRequest (Request/Reply pattern)
            cfg.ReceiveEndpoint("create-order-request", e =>
            {
                e.PrefetchCount = 1; // SQLite: process one message at a time
                e.ConfigureConsumer<ERPApi.Consumers.CreateOrderRequestConsumer>(context);
                e.UseMessageRetry(r => r.Interval(3, TimeSpan.FromSeconds(5)));
            });

            // Configure receive endpoints for state update events
            cfg.ReceiveEndpoint("erp-stock-reserved", e =>
            {
                e.PrefetchCount = 1; // SQLite: prevent database lock contention
                e.ConfigureConsumer<ERPApi.Consumers.StockReservedConsumer>(context);
                e.UseMessageRetry(r => r.Interval(3, TimeSpan.FromSeconds(5)));
            });

            cfg.ReceiveEndpoint("erp-stock-unavailable", e =>
            {
                e.PrefetchCount = 1;
                e.ConfigureConsumer<ERPApi.Consumers.StockUnavailableConsumer>(context);
                e.UseMessageRetry(r => r.Interval(3, TimeSpan.FromSeconds(5)));
            });

            cfg.ReceiveEndpoint("erp-order-picked", e =>
            {
                e.PrefetchCount = 1;
                e.ConfigureConsumer<ERPApi.Consumers.OrderPickedConsumer>(context);
                e.UseMessageRetry(r => r.Interval(3, TimeSpan.FromSeconds(5)));
            });

            cfg.ReceiveEndpoint("erp-order-packed", e =>
            {
                e.PrefetchCount = 1;
                e.ConfigureConsumer<ERPApi.Consumers.OrderPackedConsumer>(context);
                e.UseMessageRetry(r => r.Interval(3, TimeSpan.FromSeconds(5)));
            });

            // Invalid Order Channel - catch validation failures
            cfg.ReceiveEndpoint("erp-invalid-order", e =>
            {
                e.PrefetchCount = 1;
                e.ConfigureConsumer<ERPApi.Consumers.OrderInvalidConsumer>(context);
            });

            // Dead Letter Channel - catch all faulted messages
            cfg.ReceiveEndpoint("erp-dead-letter", e =>
            {
                // Fault consumer for Request-Reply pattern
                e.Consumer(() => new ERPApi.Consumers.FaultConsumer<Contracts.CreateOrderRequest>(
                    context.GetRequiredService<ILogger<ERPApi.Consumers.FaultConsumer<Contracts.CreateOrderRequest>>>(),
                    context.GetRequiredService<IOrderRepository>()));

                // Fault consumers for event-driven state updates
                e.Consumer(() => new ERPApi.Consumers.FaultConsumer<Contracts.Events.OrderCreated>(
                    context.GetRequiredService<ILogger<ERPApi.Consumers.FaultConsumer<Contracts.Events.OrderCreated>>>(),
                    context.GetRequiredService<IOrderRepository>()));

                e.Consumer(() => new ERPApi.Consumers.FaultConsumer<Contracts.Events.StockReserved>(
                    context.GetRequiredService<ILogger<ERPApi.Consumers.FaultConsumer<Contracts.Events.StockReserved>>>(),
                    context.GetRequiredService<IOrderRepository>()));

                e.Consumer(() => new ERPApi.Consumers.FaultConsumer<Contracts.Events.StockUnavailable>(
                    context.GetRequiredService<ILogger<ERPApi.Consumers.FaultConsumer<Contracts.Events.StockUnavailable>>>(),
                    context.GetRequiredService<IOrderRepository>()));

                e.Consumer(() => new ERPApi.Consumers.FaultConsumer<Contracts.Events.OrderPicked>(
                    context.GetRequiredService<ILogger<ERPApi.Consumers.FaultConsumer<Contracts.Events.OrderPicked>>>(),
                    context.GetRequiredService<IOrderRepository>()));

                e.Consumer(() => new ERPApi.Consumers.FaultConsumer<Contracts.Events.OrderPacked>(
                    context.GetRequiredService<ILogger<ERPApi.Consumers.FaultConsumer<Contracts.Events.OrderPacked>>>(),
                    context.GetRequiredService<IOrderRepository>()));
            });

            cfg.ConfigureEndpoints(context);
        });
    });

    // Database with SQLite optimized for concurrent access
    builder.Services.AddDbContext<OrderDbContext>(options =>
    {
        var connectionString = builder.Configuration.GetConnectionString("DefaultConnection");

        options.UseSqlite(connectionString, sqliteOptions =>
            {
                sqliteOptions.CommandTimeout(30);
            })
            .EnableSensitiveDataLogging(builder.Environment.IsDevelopment())
            .EnableDetailedErrors(builder.Environment.IsDevelopment());
    },
    ServiceLifetime.Scoped);

    // services
    builder.Services.AddScoped<IOrderRepository, OrderRepositroy>();
    builder.Services.AddScoped<IOrderService, OrderService>();

    // FluentValidation
    builder.Services.AddScoped<IValidator<Entities.Model.Order>, ERPApi.Services.Validation.OrderValidator>();
    var app = builder.Build();

    // Initialize SQLite for concurrent access (WAL mode)
    try
    {
        using (var scope = app.Services.CreateScope())
        {
            var dbContext = scope.ServiceProvider.GetRequiredService<OrderDbContext>();
            var connection = dbContext.Database.GetDbConnection();
            await connection.OpenAsync();
            using (var command = connection.CreateCommand())
            {
                command.CommandText = @"
                PRAGMA journal_mode=WAL;
                PRAGMA busy_timeout=5000;
                PRAGMA synchronous=NORMAL;
            ";
                await command.ExecuteNonQueryAsync();
            }
            Log.Information("SQLite initialized with WAL mode for concurrent access");
        }
    }
    catch (Exception ex)
    {
        // Ignore errors during design-time (migrations)
        Log.Debug(ex, "Could not initialize SQLite (likely during design-time)");
    }

    app.MapOpenApi();
    app.MapScalarApiReference();
    app.UseCors(); // Enable CORS middleware
    app.UseHttpsRedirection();
    app.UseAuthorization();
    app.MapControllers();

    Log.Information("ERPApi started successfully");
    app.Run();
}
catch (Exception ex)
{
    Log.Fatal(ex, "ERPApi terminated unexpectedly");
}
finally
{
    Log.CloseAndFlush();
}



================================================
FILE: ERPApi/Configuration/RabbitMqSettings.cs
================================================
﻿namespace ERPApi.Configuration
{
    public class RabbitMqSettings
    {
        public string Host { get; set; } = string.Empty;
        public string Port { get; set; } = "/";
        public string Username { get; set; } = string.Empty;
        public string Password { get; set; } = string.Empty;
    }
}



================================================
FILE: ERPApi/Configuration/SeqSettings.cs
================================================
﻿namespace ERPApi.Configuration
{
    public class SeqSettings
    {
        public required string BaseUrl { get; set; }
        public required string ApiKey { get; set; }
    }
}



================================================
FILE: ERPApi/Consumers/CreateOrderRequestConsumer.cs
================================================
using Contracts;
using Contracts.Events;
using ERPApi.Services.Order;
using ERPApi.Services.Validation;
using FluentValidation;
using MassTransit;
using Microsoft.EntityFrameworkCore;
using System.Text.Json;

namespace ERPApi.Consumers
{
    public class CreateOrderRequestConsumer : IConsumer<CreateOrderRequest>
    {
        private readonly IOrderService _orderService;
        private readonly IValidator<Entities.Model.Order> _orderValidator;
        private readonly ILogger<CreateOrderRequestConsumer> _logger;

        public CreateOrderRequestConsumer(
            IOrderService orderService,
            IValidator<Entities.Model.Order> orderValidator,
            ILogger<CreateOrderRequestConsumer> logger)
        {
            _orderService = orderService;
            _orderValidator = orderValidator;
            _logger = logger;
        }

        public async Task Consume(ConsumeContext<CreateOrderRequest> context)
        {
            var request = context.Message;
            var correlationId = request.CorrelationId?.ToString() ?? Guid.NewGuid().ToString();
            
            using (_logger.BeginScope(new Dictionary<string, object>
            {
                ["CorrelationId"] = correlationId,
                ["CustomerId"] = request.Order.CustomerId
            }))
            {
                _logger.LogInformation("[ERP-Api] CreateOrderRequest received. CustomerId={CustomerId}",
                    request.Order.CustomerId);

                var validationResult = await _orderValidator.ValidateAsync(request.Order);
            
            if (!validationResult.IsValid)
            {
                var validationErrors = validationResult.Errors.Select(e => e.ErrorMessage).ToList();
                
                _logger.LogWarning("[ERP-Api] Order validation failed. CustomerId={CustomerId}, Errors={Errors}",
                    request.Order.CustomerId,
                    string.Join(", ", validationErrors));

                await context.Publish(new OrderInvalid
                {
                    OrderId = request.Order.Id,
                    CorrelationId = request.CorrelationId ?? Guid.NewGuid(),
                    InvalidatedAt = DateTime.UtcNow,
                    Reason = "Order validation failed",
                    ValidationErrors = validationErrors,
                    OrderJson = JsonSerializer.Serialize(request.Order)
                });

                await context.RespondAsync(new CreateOrderResponse
                {
                    OrderNo = 0,
                    IsSuccessfullyCreated = false,
                    ErrorMessage = $"Validation failed: {string.Join("; ", validationErrors)}"
                });

                _logger.LogInformation("[ERP-Api] OrderInvalid event published.");

                return;
            }

            try
            {
                var orderNo = await _orderService.CreateAndSendOrderAsync(request.Order);

                _logger.LogInformation("[ERP-Api] Order created. OrderNo={OrderNo}, CustomerId={CustomerId}",
                    orderNo, request.Order.CustomerId);

                await context.RespondAsync(new CreateOrderResponse
                {
                    OrderNo = orderNo,
                    IsSuccessfullyCreated = true,
                    ErrorMessage = string.Empty
                });
            }
            catch (DbUpdateException ex)
            {
                _logger.LogError(ex, "[ERP-Api] Transient DB error. CustomerId={CustomerId}, Will retry.",
                    request.Order.CustomerId);
                
                throw;
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "[ERP-Api] Business error. CustomerId={CustomerId}, No retry.",
                    request.Order.CustomerId);

                await context.RespondAsync(new CreateOrderResponse
                {
                    OrderNo = 0,
                    IsSuccessfullyCreated = false,
                    ErrorMessage = ex.Message + (ex.InnerException != null ? " | " + ex.InnerException.Message : string.Empty)
                });
            }
            }
        }
    }
}



================================================
FILE: ERPApi/Consumers/FaultConsumer.cs
================================================
using ERPApi.Repository.Order;
using MassTransit;

namespace ERPApi.Consumers
{
    public class FaultConsumer<T> : IConsumer<Fault<T>> where T : class
    {
        private readonly ILogger<FaultConsumer<T>> _logger;
        private readonly IOrderRepository _orderRepository;

        public FaultConsumer(ILogger<FaultConsumer<T>> logger, IOrderRepository orderRepository)
        {
            _logger = logger;
            _orderRepository = orderRepository;
        }

        public async Task Consume(ConsumeContext<Fault<T>> context)
        {
            var fault = context.Message;
            var messageType = typeof(T).Name;

            _logger.LogCritical(
                "[ERP-Api] Faulted message moved to dead letter queue. MessageType={MessageType}, FaultId={FaultId}, ExceptionCount={ExceptionCount}",
                messageType, fault.FaultId, fault.Exceptions?.Length ?? 0);

            if (fault.Exceptions != null && fault.Exceptions.Any())
            {
                foreach (var exception in fault.Exceptions)
                {
                    _logger.LogCritical("[ERP-Api] Exception: {ExceptionType} - {Message}",
                        exception.ExceptionType, exception.Message);
                }
            }

            // Store the faulted message for manual investigation
            try
            {
                await _orderRepository.StoreFaultedMessageAsync(fault, 999);
                _logger.LogInformation("[ERP-Api] Faulted message stored for manual investigation. FaultId={FaultId}", fault.FaultId);
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "[ERP-Api] Failed to store faulted message. FaultId={FaultId}", fault.FaultId);
            }

            // Alert operations team (in production, this would integrate with alerting systems)
            _logger.LogCritical("[ERP-Api] 🚨 MANUAL INTERVENTION REQUIRED: Message {FaultId} requires investigation", fault.FaultId);
        }
    }
}



================================================
FILE: ERPApi/Consumers/OrderInvalidConsumer.cs
================================================
using Contracts.Events;
using MassTransit;

namespace ERPApi.Consumers
{
    public class OrderInvalidConsumer : IConsumer<OrderInvalid>
    {
        private readonly ILogger<OrderInvalidConsumer> _logger;

        public OrderInvalidConsumer(ILogger<OrderInvalidConsumer> logger)
        {
            _logger = logger;
        }

        public async Task Consume(ConsumeContext<OrderInvalid> context)
        {
            var message = context.Message;
            
            _logger.LogWarning(
                "[ERP-Api] Invalid order received. OrderId={OrderId}, Reason={Reason}, Errors={Errors}",
                message.OrderId,
                message.Reason,
                string.Join(", ", message.ValidationErrors));

            await Task.CompletedTask;
        }
    }
}



================================================
FILE: ERPApi/Consumers/OrderPackedConsumer.cs
================================================
using Contracts.Events;
using ERPApi.DBContext;
using MassTransit;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;

namespace ERPApi.Consumers
{
    /// <summary>
    /// Consumes OrderPacked events and updates order state to final completed state.
    /// Event-driven state update (no HTTP calls).
    /// </summary>
    public class OrderPackedConsumer : IConsumer<OrderPacked>
    {
        private readonly OrderDbContext _context;
        private readonly ILogger<OrderPackedConsumer> _logger;

        public OrderPackedConsumer(
            OrderDbContext context, 
            ILogger<OrderPackedConsumer> logger)
        {
            _context = context;
            _logger = logger;
        }

        public async Task Consume(ConsumeContext<OrderPacked> context)
        {
            var message = context.Message;
            
            _logger.LogInformation("Received OrderPacked event for Order {OrderId} (CorrelationId: {CorrelationId})",
                message.OrderId, message.CorrelationId);

            var maxRetries = 3;
            var retryCount = 0;
            
            while (retryCount < maxRetries)
            {
                try
                {
                    var order = await _context.Orders
                        .Include(o => o.OrderItems)
                        .FirstOrDefaultAsync(o => o.Id == message.OrderId);

                    if (order == null)
                    {
                        _logger.LogWarning("Order {OrderId} not found when processing OrderPacked event (CorrelationId: {CorrelationId})",
                            message.OrderId, message.CorrelationId);
                        return;
                    }

                    order.OrderState = "Packed";
                    
                    var packedSkus = new HashSet<string>(message.Items.Select(i => i.Sku ?? string.Empty));
                    
                    foreach (var item in order.OrderItems)
                    {
                        if (packedSkus.Contains(item.Sku ?? string.Empty))
                        {
                            item.Status = "Packed";
                        }
                    }
                    
                    _context.Orders.Update(order);
                    await _context.SaveChangesAsync();

                    _logger.LogInformation("Updated Order {OrderId} state to Packed (final state), {PackedCount} items marked as Packed (CorrelationId: {CorrelationId})",
                        message.OrderId, message.Items.Count, message.CorrelationId);
                    
                    return;
                }
                catch (DbUpdateConcurrencyException ex)
                {
                    retryCount++;
                    _logger.LogWarning(ex, "Concurrency conflict updating order. OrderId={OrderId}, Retry={RetryCount}/{MaxRetries}",
                        message.OrderId, retryCount, maxRetries);
                    
                    var entry = ex.Entries.FirstOrDefault();
                    if (entry != null)
                    {
                        await entry.ReloadAsync();
                    }
                    
                    if (retryCount >= maxRetries)
                    {
                        _logger.LogError(ex, "Failed to update order after {MaxRetries} attempts. OrderId={OrderId}",
                            maxRetries, message.OrderId);
                        throw;
                    }
                    
                    await Task.Delay(TimeSpan.FromMilliseconds(100 * retryCount));
                }
                catch (Exception ex)
                {
                    _logger.LogError(ex, "Error updating order state for Order {OrderId} (CorrelationId: {CorrelationId})",
                        message.OrderId, message.CorrelationId);
                    throw;
                }
            }
        }
    }
}



================================================
FILE: ERPApi/Consumers/OrderPickedConsumer.cs
================================================
using Contracts.Events;
using ERPApi.DBContext;
using MassTransit;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;

namespace ERPApi.Consumers
{
    /// <summary>
    /// Consumes OrderPicked events and updates order state in database.
    /// Event-driven state update (no HTTP calls).
    /// </summary>
    public class OrderPickedConsumer : IConsumer<OrderPicked>
    {
        private readonly OrderDbContext _context;
        private readonly ILogger<OrderPickedConsumer> _logger;

        public OrderPickedConsumer(
            OrderDbContext context, 
            ILogger<OrderPickedConsumer> logger)
        {
            _context = context;
            _logger = logger;
        }

        public async Task Consume(ConsumeContext<OrderPicked> context)
        {
            var message = context.Message;
            
            _logger.LogInformation("Received OrderPicked event for Order {OrderId} (CorrelationId: {CorrelationId})",
                message.OrderId, message.CorrelationId);

            var maxRetries = 3;
            var retryCount = 0;
            
            while (retryCount < maxRetries)
            {
                try
                {
                    var order = await _context.Orders
                        .Include(o => o.OrderItems)
                        .FirstOrDefaultAsync(o => o.Id == message.OrderId);

                    if (order == null)
                    {
                        _logger.LogWarning("Order {OrderId} not found when processing OrderPicked event (CorrelationId: {CorrelationId})",
                            message.OrderId, message.CorrelationId);
                        return;
                    }

                    order.OrderState = "Picked";
                    
                    var pickedSkus = new HashSet<string>(message.Items.Select(i => i.Sku ?? string.Empty));
                    
                    foreach (var item in order.OrderItems)
                    {
                        if (pickedSkus.Contains(item.Sku ?? string.Empty))
                        {
                            item.Status = "Picked";
                        }
                    }
                    
                    _context.Orders.Update(order);
                    await _context.SaveChangesAsync();

                    _logger.LogInformation("Updated Order {OrderId} state to Picked, {PickedCount} items marked as Picked (CorrelationId: {CorrelationId})",
                        message.OrderId, message.Items.Count, message.CorrelationId);
                    
                    return;
                }
                catch (DbUpdateConcurrencyException ex)
                {
                    retryCount++;
                    _logger.LogWarning(ex, "Concurrency conflict updating order. OrderId={OrderId}, Retry={RetryCount}/{MaxRetries}",
                        message.OrderId, retryCount, maxRetries);
                    
                    var entry = ex.Entries.FirstOrDefault();
                    if (entry != null)
                    {
                        await entry.ReloadAsync();
                    }
                    
                    if (retryCount >= maxRetries)
                    {
                        _logger.LogError(ex, "Failed to update order after {MaxRetries} attempts. OrderId={OrderId}",
                            maxRetries, message.OrderId);
                        throw;
                    }
                    
                    await Task.Delay(TimeSpan.FromMilliseconds(100 * retryCount));
                }
                catch (Exception ex)
                {
                    _logger.LogError(ex, "Error updating order state for Order {OrderId} (CorrelationId: {CorrelationId})",
                        message.OrderId, message.CorrelationId);
                    throw;
                }
            }
        }
    }
}



================================================
FILE: ERPApi/Consumers/StockReservedConsumer.cs
================================================
using Contracts.Events;
using ERPApi.DBContext;
using MassTransit;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;

namespace ERPApi.Consumers
{
    public class StockReservedConsumer : IConsumer<StockReserved>
    {
        private readonly OrderDbContext _context;
        private readonly ILogger<StockReservedConsumer> _logger;

        public StockReservedConsumer(
            OrderDbContext context, 
            ILogger<StockReservedConsumer> logger)
        {
            _context = context;
            _logger = logger;
        }

        public async Task Consume(ConsumeContext<StockReserved> context)
        {
            var message = context.Message;
            
            _logger.LogInformation("[ERP-Api] StockReserved event received. OrderId={OrderId}, Partial={IsPartial} ({Reserved}/{Requested})",
                message.OrderId, message.IsPartialReservation, message.TotalReserved, message.TotalRequested);

            var maxRetries = 3;
            var retryCount = 0;
            
            while (retryCount < maxRetries)
            {
                try
                {
                    var order = await _context.Orders
                        .Include(o => o.OrderItems)
                        .FirstOrDefaultAsync(o => o.Id == message.OrderId);

                    if (order == null)
                    {
                        _logger.LogWarning("[ERP-Api] Order not found. OrderId={OrderId}",
                            message.OrderId);
                        return;
                    }

                    order.OrderState = message.IsPartialReservation ? "PartialDelivered" : "StockReserved";
                    
                    if (message.IsPartialReservation)
                    {
                        var reservedSkus = new HashSet<string>(message.Items.Select(i => i.Sku ?? string.Empty));
                        
                        foreach (var item in order.OrderItems)
                        {
                            item.Status = reservedSkus.Contains(item.Sku ?? string.Empty) ? "Available" : "Unavailable";
                        }
                        
                        var availableSkusLog = string.Join(", ", message.Items.Select(i => $"{i.Sku} (Qty: {i.Quantity})"));
                        _logger.LogWarning("[ERP-Api] Partial stock availability. OrderId={OrderId}, AvailableItems=[{AvailableItems}]",
                            message.OrderId, availableSkusLog);
                    }
                    else
                    {
                        foreach (var item in order.OrderItems)
                        {
                            item.Status = "Available";
                        }
                    }
                    
                    _context.Orders.Update(order);
                    await _context.SaveChangesAsync();

                    _logger.LogInformation("[ERP-Api] Order state updated. OrderId={OrderId}, State={OrderState}, Reserved={Reserved}/{Requested}",
                        message.OrderId, order.OrderState, message.TotalReserved, message.TotalRequested);
                    
                    return; // Success - exit retry loop
                }
                catch (DbUpdateConcurrencyException ex)
                {
                    retryCount++;
                    _logger.LogWarning(ex, "[ERP-Api] Concurrency conflict updating order. OrderId={OrderId}, Retry={RetryCount}/{MaxRetries}",
                        message.OrderId, retryCount, maxRetries);
                    
                    // Reload entity from database to get latest version
                    var entry = ex.Entries.FirstOrDefault();
                    if (entry != null)
                    {
                        await entry.ReloadAsync();
                    }
                    
                    if (retryCount >= maxRetries)
                    {
                        _logger.LogError(ex, "[ERP-Api] Failed to update order after {MaxRetries} attempts. OrderId={OrderId}",
                            maxRetries, message.OrderId);
                        throw;
                    }
                    
                    // Wait before retrying
                    await Task.Delay(TimeSpan.FromMilliseconds(100 * retryCount));
                }
                catch (Exception ex)
                {
                    _logger.LogError(ex, "[ERP-Api] Error updating order state. OrderId={OrderId}",
                        message.OrderId);
                    throw;
                }
            }
        }
    }
}



================================================
FILE: ERPApi/Consumers/StockUnavailableConsumer.cs
================================================
using Contracts.Events;
using ERPApi.DBContext;
using MassTransit;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Logging;

namespace ERPApi.Consumers
{
    /// <summary>
    /// Consumes StockUnavailable events and updates order state to terminal failed state.
    /// Event-driven state update (no HTTP calls).
    /// </summary>
    public class StockUnavailableConsumer : IConsumer<StockUnavailable>
    {
        private readonly OrderDbContext _context;
        private readonly ILogger<StockUnavailableConsumer> _logger;

        public StockUnavailableConsumer(OrderDbContext context, ILogger<StockUnavailableConsumer> logger)
        {
            _context = context;
            _logger = logger;
        }

        public async Task Consume(ConsumeContext<StockUnavailable> context)
        {
            var message = context.Message;
            
            _logger.LogWarning("Received StockUnavailable event for Order {OrderId}. Unavailable SKUs: {UnavailableSkus} (CorrelationId: {CorrelationId})",
                message.OrderId, string.Join(", ", message.UnavailableSkus), message.CorrelationId);

            var maxRetries = 3;
            var retryCount = 0;
            
            while (retryCount < maxRetries)
            {
                try
                {
                    var order = await _context.Orders
                        .Include(o => o.OrderItems)
                        .FirstOrDefaultAsync(o => o.Id == message.OrderId);

                    if (order == null)
                    {
                        _logger.LogWarning("Order {OrderId} not found when processing StockUnavailable event (CorrelationId: {CorrelationId})",
                            message.OrderId, message.CorrelationId);
                        return;
                    }

                    order.OrderState = "StockUnavailable";
                    
                    foreach (var item in order.OrderItems)
                    {
                        item.Status = "Unavailable";
                    }
                    
                    _context.Orders.Update(order);
                    await _context.SaveChangesAsync();

                    _logger.LogInformation("Updated Order {OrderId} state to StockUnavailable, all {ItemCount} items marked as Unavailable (CorrelationId: {CorrelationId}). Reason: {Reason}",
                        message.OrderId, order.OrderItems.Count, message.CorrelationId, message.Reason);
                    
                    return;
                }
                catch (DbUpdateConcurrencyException ex)
                {
                    retryCount++;
                    _logger.LogWarning(ex, "Concurrency conflict updating order. OrderId={OrderId}, Retry={RetryCount}/{MaxRetries}",
                        message.OrderId, retryCount, maxRetries);
                    
                    var entry = ex.Entries.FirstOrDefault();
                    if (entry != null)
                    {
                        await entry.ReloadAsync();
                    }
                    
                    if (retryCount >= maxRetries)
                    {
                        _logger.LogError(ex, "Failed to update order after {MaxRetries} attempts. OrderId={OrderId}",
                            maxRetries, message.OrderId);
                        throw;
                    }
                    
                    await Task.Delay(TimeSpan.FromMilliseconds(100 * retryCount));
                }
                catch (Exception ex)
                {
                    _logger.LogError(ex, "Error updating order state for Order {OrderId} (CorrelationId: {CorrelationId})",
                        message.OrderId, message.CorrelationId);
                    throw;
                }
            }
        }
    }
}



================================================
FILE: ERPApi/Controllers/LogsController.cs
================================================
using ERPApi.Configuration;
using Microsoft.AspNetCore.Mvc;

namespace ERPApi.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class LogsController : ControllerBase
    {
        private readonly IHttpClientFactory _httpClientFactory;
        private readonly ILogger<LogsController> _logger;
        private readonly SeqSettings _seqSettings;

        public LogsController(IHttpClientFactory httpClientFactory, ILogger<LogsController> logger, SeqSettings seqSettings)
        {
            _httpClientFactory = httpClientFactory;
            _logger = logger;
            _seqSettings = seqSettings ?? throw new ArgumentNullException(nameof(seqSettings));
        }

        [HttpGet("by-orderid/{orderId}")]
        public async Task<IActionResult> GetLogsByOrderId(string orderId, [FromQuery] int count = 100)
        {
            try
            {
                var httpClient = _httpClientFactory.CreateClient();
                
                // Add Seq API key header
                if (!string.IsNullOrEmpty(_seqSettings.ApiKey))
                {
                    httpClient.DefaultRequestHeaders.Add("X-Seq-ApiKey", _seqSettings.ApiKey);
                }

                var filter = Uri.EscapeDataString($"OrderId='{orderId}'");
                var seqUrl = $"{_seqSettings.BaseUrl}/api/events?filter={filter}&count={count}&render=false";
                
                _logger.LogDebug("Fetching logs from Seq: {SeqUrl}", seqUrl);
                
                var response = await httpClient.GetAsync(seqUrl);

                if (!response.IsSuccessStatusCode)
                {
                    _logger.LogWarning("Failed to fetch logs from Seq. Status: {StatusCode}", response.StatusCode);
                    return StatusCode((int)response.StatusCode, "Failed to fetch logs from Seq");
                }

                var content = await response.Content.ReadAsStringAsync();
                return Content(content, "application/json");
            }
            catch (HttpRequestException ex)
            {
                _logger.LogError(ex, "Seq service is unavailable");
                return StatusCode(503, new { error = "Seq service is unavailable", message = ex.Message });
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Error fetching logs from Seq");
                return StatusCode(500, new { error = "Internal server error", message = ex.Message });
            }
        }
    }
}



================================================
FILE: ERPApi/Controllers/OrderController.cs
================================================
﻿using Entities.Model;
using ERPApi.Services.Order;
using Microsoft.AspNetCore.Mvc;
using Contracts;
using Contracts.DTOs;

namespace ERPApi.Controllers
{
    [Route("api/[controller]")]
    [ApiController]
    public class OrderController : ControllerBase
    {
        private IOrderService _orderService;
        public OrderController(IOrderService orderService)
        {
            _orderService = orderService;
        }

        [HttpPost]
        public async Task<IActionResult> CreateOrderAsync([FromBody] Order order)
        {
            if (order == null)
                return BadRequest(new CreateOrderResponse() { ErrorMessage = "Order can't be null" });

            try
            {
                var createdOrderNo = await _orderService.CreateAndSendOrderAsync(order);
                var response = new CreateOrderResponse
                {
                    OrderNo = createdOrderNo,
                    IsSuccessfullyCreated = true,
                    ErrorMessage = string.Empty
                };

                return Ok(response);
            }
            catch (Exception ex)
            {
                var response = new CreateOrderResponse
                {
                    OrderNo = 0,
                    IsSuccessfullyCreated = false,
                    ErrorMessage = ex.Message + ex.InnerException?.Message
                };

                return StatusCode(500, response);
            }
        }

        [HttpGet]
        public async Task<IActionResult> GetAllOrders()
        {
            try
            {
                var orders = await _orderService.GetAllOrders();
                return Ok(orders);
            }
            catch (Exception ex)
            {
                return StatusCode(500, $"Internal server error: {ex.Message}");
            }
        }

        [HttpGet("{id}")]
        public async Task<IActionResult> GetOrderById(Guid id)
        {
            try
            {
                var order = await _orderService.GetOrderById(id);
                if (order == null)
                    return NotFound($"Order with ID {id} not found.");

                return Ok(order);
            }
            catch (Exception ex)
            {
                return StatusCode(500, $"Internal server error: {ex.Message}");
            }
        }

        [HttpGet("dead-letter")]
        public async Task<IActionResult> GetDeadLetterMessages()
        {
            try
            {
                var faultedMessages = await _orderService.GetFaultedMessagesAsync();
                return Ok(faultedMessages);
            }
            catch (Exception ex)
            {
                return StatusCode(500, $"Internal server error: {ex.Message}");
            }
        }
    }
}



================================================
FILE: ERPApi/DBContext/OrderDbContext.cs
================================================
﻿using Entities.Model;
using MassTransit;
using Microsoft.EntityFrameworkCore;

namespace ERPApi.DBContext
{
    public class OrderDbContext : DbContext
    {
        public OrderDbContext(DbContextOptions<OrderDbContext> options) : base(options)
        {
        }

        public DbSet<Order> Orders { get; set; }
        public DbSet<OrderItem> OrderItems { get; set; }

        protected override void OnModelCreating(ModelBuilder modelBuilder)
        {
            base.OnModelCreating(modelBuilder);
            
            // Add MassTransit Outbox tables (for transactional event publishing)
            modelBuilder.AddInboxStateEntity();
            modelBuilder.AddOutboxMessageEntity();
            modelBuilder.AddOutboxStateEntity();

            modelBuilder.Entity<Order>(entity =>
            {
                entity.HasKey(e => e.Id);

                entity.HasIndex(e => e.OrderNo).IsUnique();
                
                // Configure RowVersion for optimistic concurrency control
                entity.Property(e => e.RowVersion)
                    .IsRowVersion()
                    .IsConcurrencyToken();

                // Own simple single-value objects as owned types (flattened columns)
                entity.OwnsOne(o => o.Customer, cb =>
                {
                    cb.Property(c => c.Id).HasColumnName("CustomerId");
                    cb.Property(c => c.FirstName).HasColumnName("CustomerFirstName");
                    cb.Property(c => c.LastName).HasColumnName("CustomerLastName");
                    cb.Property(c => c.Email).HasColumnName("CustomerEmail");
                    cb.Property(c => c.Phone).HasColumnName("CustomerPhone");
                });

                entity.OwnsOne(o => o.Payment, pb =>
                {
                    pb.Property(p => p.PaymentMethod).HasColumnName("PaymentMethod");
                    pb.Property(p => p.PaymentStatus).HasColumnName("PaymentStatus");
                    pb.Property(p => p.PaidAt).HasColumnName("PaidAt");
                    pb.Property(p => p.Currency).HasColumnName("Currency");
                    pb.Property(p => p.Amount).HasColumnName("PaymentAmount");
                });

                entity.OwnsOne(o => o.ShippingAddress, ab =>
                {
                    ab.Property(a => a.Street).HasColumnName("Ship_Street");
                    ab.Property(a => a.City).HasColumnName("Ship_City");
                    ab.Property(a => a.State).HasColumnName("Ship_State");
                    ab.Property(a => a.PostalCode).HasColumnName("Ship_PostalCode");
                    ab.Property(a => a.Country).HasColumnName("Ship_Country");
                });

                // Configure relationship to OrderItems
                entity.HasMany(o => o.OrderItems)
                      .WithOne()
                      .HasForeignKey(oi => oi.OrderId)
                      .IsRequired();
            });

            modelBuilder.Entity<OrderItem>(item =>
            {
                item.HasKey(i => i.Id);
                item.Property(i => i.Sku).IsRequired();
                item.Property(i => i.Name).IsRequired();
                item.Property<Guid>("OrderId");
                
                // Configure Status property with default value
                item.Property(i => i.Status)
                    .IsRequired()
                    .HasMaxLength(20)
                    .HasDefaultValue("Pending");
            });
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251009205345_InitialCreate.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class InitialCreate : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.CreateTable(
                name: "Orders",
                columns: table => new
                {
                    Id = table.Column<Guid>(type: "TEXT", nullable: false),
                    OrderNo = table.Column<string>(type: "TEXT", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "TEXT", nullable: false),
                    OrderStatus = table.Column<string>(type: "TEXT", nullable: false),
                    CountryCode = table.Column<string>(type: "TEXT", nullable: false),
                    IsPreOrder = table.Column<bool>(type: "INTEGER", nullable: false),
                    TotalAmount = table.Column<decimal>(type: "TEXT", nullable: false),
                    CustomerId = table.Column<Guid>(type: "TEXT", nullable: false),
                    CustomerFirstName = table.Column<string>(type: "TEXT", nullable: false),
                    CustomerLastName = table.Column<string>(type: "TEXT", nullable: false),
                    CustomerEmail = table.Column<string>(type: "TEXT", nullable: false),
                    CustomerPhone = table.Column<string>(type: "TEXT", nullable: false),
                    PaymentMethod = table.Column<string>(type: "TEXT", nullable: false),
                    PaymentStatus = table.Column<string>(type: "TEXT", nullable: false),
                    PaidAt = table.Column<DateTime>(type: "TEXT", nullable: false),
                    TransactionId = table.Column<string>(type: "TEXT", nullable: false),
                    Currency = table.Column<string>(type: "TEXT", nullable: false),
                    PaymentAmount = table.Column<decimal>(type: "TEXT", nullable: false),
                    Ship_Street = table.Column<string>(type: "TEXT", nullable: false),
                    Ship_City = table.Column<string>(type: "TEXT", nullable: false),
                    Ship_State = table.Column<string>(type: "TEXT", nullable: false),
                    Ship_PostalCode = table.Column<string>(type: "TEXT", nullable: false),
                    Ship_Country = table.Column<string>(type: "TEXT", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Orders", x => x.Id);
                });

            migrationBuilder.CreateTable(
                name: "OrderItems",
                columns: table => new
                {
                    Id = table.Column<Guid>(type: "TEXT", nullable: false),
                    OrderId = table.Column<Guid>(type: "TEXT", nullable: false),
                    Sku = table.Column<string>(type: "TEXT", nullable: false),
                    Name = table.Column<string>(type: "TEXT", nullable: false),
                    Quantity = table.Column<int>(type: "INTEGER", nullable: false),
                    UnitPrice = table.Column<decimal>(type: "TEXT", nullable: false),
                    TotalPrice = table.Column<decimal>(type: "TEXT", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_OrderItems", x => x.Id);
                    table.ForeignKey(
                        name: "FK_OrderItems_Orders_OrderId",
                        column: x => x.OrderId,
                        principalTable: "Orders",
                        principalColumn: "Id",
                        onDelete: ReferentialAction.Cascade);
                });

            migrationBuilder.CreateIndex(
                name: "IX_OrderItems_OrderId",
                table: "OrderItems",
                column: "OrderId");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "OrderItems");

            migrationBuilder.DropTable(
                name: "Orders");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251009205345_InitialCreate.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251009205345_InitialCreate")]
    partial class InitialCreate
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderNo")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.Property<string>("TransactionId")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("TransactionId");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251009210504_NormalizeOrderModel.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class NormalizeOrderModel : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "TransactionId",
                table: "Orders");

            migrationBuilder.AlterColumn<DateTime>(
                name: "PaidAt",
                table: "Orders",
                type: "TEXT",
                nullable: true,
                oldClrType: typeof(DateTime),
                oldType: "TEXT");

            migrationBuilder.AlterColumn<bool>(
                name: "IsPreOrder",
                table: "Orders",
                type: "INTEGER",
                nullable: true,
                oldClrType: typeof(bool),
                oldType: "INTEGER");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AlterColumn<DateTime>(
                name: "PaidAt",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                defaultValue: new DateTime(1, 1, 1, 0, 0, 0, 0, DateTimeKind.Unspecified),
                oldClrType: typeof(DateTime),
                oldType: "TEXT",
                oldNullable: true);

            migrationBuilder.AlterColumn<bool>(
                name: "IsPreOrder",
                table: "Orders",
                type: "INTEGER",
                nullable: false,
                defaultValue: false,
                oldClrType: typeof(bool),
                oldType: "INTEGER",
                oldNullable: true);

            migrationBuilder.AddColumn<string>(
                name: "TransactionId",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                defaultValue: "");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251009210504_NormalizeOrderModel.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251009210504_NormalizeOrderModel")]
    partial class NormalizeOrderModel
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderNo")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010141944_AddUniqueIndexOnOrderNo.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class AddUniqueIndexOnOrderNo : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AlterColumn<int>(
                name: "OrderNo",
                table: "Orders",
                type: "INTEGER",
                nullable: false,
                oldClrType: typeof(string),
                oldType: "TEXT");

            migrationBuilder.CreateIndex(
                name: "IX_Orders_OrderNo",
                table: "Orders",
                column: "OrderNo",
                unique: true);
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropIndex(
                name: "IX_Orders_OrderNo",
                table: "Orders");

            migrationBuilder.AlterColumn<string>(
                name: "OrderNo",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                oldClrType: typeof(int),
                oldType: "INTEGER");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010141944_AddUniqueIndexOnOrderNo.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010141944_AddUniqueIndexOnOrderNo")]
    partial class AddUniqueIndexOnOrderNo
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010142305_RecreateSchema.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class RecreateSchema : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "TransactionId",
                table: "Orders");

            migrationBuilder.AlterColumn<DateTime>(
                name: "PaidAt",
                table: "Orders",
                type: "TEXT",
                nullable: true,
                oldClrType: typeof(DateTime),
                oldType: "TEXT");

            migrationBuilder.AlterColumn<int>(
                name: "OrderNo",
                table: "Orders",
                type: "INTEGER",
                nullable: false,
                oldClrType: typeof(string),
                oldType: "TEXT");

            migrationBuilder.AlterColumn<bool>(
                name: "IsPreOrder",
                table: "Orders",
                type: "INTEGER",
                nullable: true,
                oldClrType: typeof(bool),
                oldType: "INTEGER");

            // Use raw SQL with IF NOT EXISTS to avoid duplicate index errors on SQLite
            migrationBuilder.Sql("CREATE UNIQUE INDEX IF NOT EXISTS \"IX_Orders_OrderNo\" ON \"Orders\" (\"OrderNo\");");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            // Use DROP INDEX IF EXISTS to safely drop the index on SQLite
            migrationBuilder.Sql("DROP INDEX IF EXISTS \"IX_Orders_OrderNo\";");

            migrationBuilder.AlterColumn<DateTime>(
                name: "PaidAt",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                defaultValue: new DateTime(1, 1, 1, 0, 0, 0, 0, DateTimeKind.Unspecified),
                oldClrType: typeof(DateTime),
                oldType: "TEXT",
                oldNullable: true);

            migrationBuilder.AlterColumn<string>(
                name: "OrderNo",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                oldClrType: typeof(int),
                oldType: "INTEGER");

            migrationBuilder.AlterColumn<bool>(
                name: "IsPreOrder",
                table: "Orders",
                type: "INTEGER",
                nullable: false,
                defaultValue: false,
                oldClrType: typeof(bool),
                oldType: "INTEGER",
                oldNullable: true);

            migrationBuilder.AddColumn<string>(
                name: "TransactionId",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                defaultValue: "");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010142305_RecreateSchema.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010142305_RecreateSchema")]
    partial class RecreateSchema
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010174948_ApplyModelChanges.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class ApplyModelChanges : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {

        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {

        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010174948_ApplyModelChanges.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010174948_ApplyModelChanges")]
    partial class ApplyModelChanges
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010175426_StartOrderNoAt1000.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class StartOrderNoAt1000 : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {

        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {

        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010175426_StartOrderNoAt1000.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010175426_StartOrderNoAt1000")]
    partial class StartOrderNoAt1000
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010185519_UserMigration.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class UserMigration : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {

        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {

        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010185519_UserMigration.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010185519_UserMigration")]
    partial class UserMigration
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010185554_FinalizeOrderNoStart1000.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class FinalizeOrderNoStart1000 : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {

        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {

        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010185554_FinalizeOrderNoStart1000.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010185554_FinalizeOrderNoStart1000")]
    partial class FinalizeOrderNoStart1000
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderStatus")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010190318_RenameOrderStatusToOrderState.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class RenameOrderStatusToOrderState : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.RenameColumn(
                name: "OrderStatus",
                table: "Orders",
                newName: "OrderState");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.RenameColumn(
                name: "OrderState",
                table: "Orders",
                newName: "OrderStatus");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251010190318_RenameOrderStatusToOrderState.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251010190318_RenameOrderStatusToOrderState")]
    partial class RenameOrderStatusToOrderState
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderState")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251011082845_OrderServiceChanges.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class OrderServiceChanges : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.CreateTable(
                name: "OrderSentToPickings",
                columns: table => new
                {
                    Id = table.Column<Guid>(type: "TEXT", nullable: false),
                    OrderNo = table.Column<int>(type: "INTEGER", nullable: false),
                    SentTime = table.Column<DateTime>(type: "TEXT", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_OrderSentToPickings", x => x.Id);
                });
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "OrderSentToPickings");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251011082845_OrderServiceChanges.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251011082845_OrderServiceChanges")]
    partial class OrderServiceChanges
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<bool?>("IsPreOrder")
                        .HasColumnType("INTEGER");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderState")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders");
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.OrderSentToPicking", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<DateTime>("SentTime")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("OrderSentToPickings");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251013200035_AddOutboxAndRemovePreOrder.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class AddOutboxAndRemovePreOrder : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "IsPreOrder",
                table: "Orders");

            migrationBuilder.AddColumn<Guid>(
                name: "Order_CustomerId",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                defaultValue: new Guid("00000000-0000-0000-0000-000000000000"));

            migrationBuilder.CreateTable(
                name: "OutboxMessages",
                columns: table => new
                {
                    Id = table.Column<Guid>(type: "TEXT", nullable: false),
                    MessageType = table.Column<string>(type: "TEXT", maxLength: 100, nullable: false),
                    Payload = table.Column<string>(type: "TEXT", nullable: false),
                    CreatedAt = table.Column<DateTime>(type: "TEXT", nullable: false),
                    ProcessedAt = table.Column<DateTime>(type: "TEXT", nullable: true),
                    RetryCount = table.Column<int>(type: "INTEGER", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_OutboxMessages", x => x.Id);
                });

            migrationBuilder.CreateIndex(
                name: "IX_OutboxMessages_CreatedAt",
                table: "OutboxMessages",
                column: "CreatedAt");

            migrationBuilder.CreateIndex(
                name: "IX_OutboxMessages_ProcessedAt",
                table: "OutboxMessages",
                column: "ProcessedAt");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "OutboxMessages");

            migrationBuilder.DropColumn(
                name: "Order_CustomerId",
                table: "Orders");

            migrationBuilder.AddColumn<bool>(
                name: "IsPreOrder",
                table: "Orders",
                type: "INTEGER",
                nullable: true);
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251013200035_AddOutboxAndRemovePreOrder.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251013200035_AddOutboxAndRemovePreOrder")]
    partial class AddOutboxAndRemovePreOrder
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "10.0.0-rc.1.25451.107");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("CustomerId")
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderState")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders", t =>
                        {
                            t.Property("CustomerId")
                                .HasColumnName("Order_CustomerId");
                        });
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.OrderSentToPicking", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<DateTime>("SentTime")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("OrderSentToPickings");
                });

            modelBuilder.Entity("Entities.Model.Outbox", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<string>("MessageType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("TEXT");

                    b.Property<string>("Payload")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("ProcessedAt")
                        .HasColumnType("TEXT");

                    b.Property<int>("RetryCount")
                        .HasColumnType("INTEGER");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ProcessedAt");

                    b.ToTable("OutboxMessages");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251015185817_AddOrderItemStatus.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class AddOrderItemStatus : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AddColumn<string>(
                name: "Status",
                table: "OrderItems",
                type: "TEXT",
                maxLength: 20,
                nullable: false,
                defaultValue: "Pending");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "Status",
                table: "OrderItems");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251017215726_AddOrderItemStatusColumn.cs
================================================
﻿using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class AddOrderItemStatusColumn : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AddColumn<string>(
                name: "Status",
                table: "OrderItems",
                type: "TEXT",
                maxLength: 20,
                nullable: false,
                defaultValue: "Pending");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropColumn(
                name: "Status",
                table: "OrderItems");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251017215726_AddOrderItemStatusColumn.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251017215726_AddOrderItemStatusColumn")]
    partial class AddOrderItemStatusColumn
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "9.0.10");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("CustomerId")
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderState")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders", t =>
                        {
                            t.Property("CustomerId")
                                .HasColumnName("Order_CustomerId");
                        });
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("Status")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasMaxLength(20)
                        .HasColumnType("TEXT")
                        .HasDefaultValue("Pending");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.OrderSentToPicking", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<DateTime>("SentTime")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("OrderSentToPickings");
                });

            modelBuilder.Entity("Entities.Model.Outbox", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<string>("MessageType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("TEXT");

                    b.Property<string>("Payload")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("ProcessedAt")
                        .HasColumnType("TEXT");

                    b.Property<int>("RetryCount")
                        .HasColumnType("INTEGER");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ProcessedAt");

                    b.ToTable("OutboxMessages");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251025103151_AddLogsAndCorrelationId.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class AddLogsAndCorrelationId : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.AddColumn<string>(
                name: "CorrelationId",
                table: "Orders",
                type: "TEXT",
                nullable: false,
                defaultValue: "");

            migrationBuilder.CreateTable(
                name: "Logs",
                columns: table => new
                {
                    Id = table.Column<Guid>(type: "TEXT", nullable: false),
                    Timestamp = table.Column<DateTime>(type: "TEXT", nullable: false),
                    Level = table.Column<string>(type: "TEXT", maxLength: 20, nullable: false),
                    Message = table.Column<string>(type: "TEXT", nullable: false),
                    Exception = table.Column<string>(type: "TEXT", nullable: true),
                    ServiceName = table.Column<string>(type: "TEXT", maxLength: 50, nullable: false),
                    CorrelationId = table.Column<string>(type: "TEXT", nullable: true),
                    OrderNo = table.Column<int>(type: "INTEGER", nullable: true),
                    Properties = table.Column<string>(type: "TEXT", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Logs", x => x.Id);
                });

            migrationBuilder.CreateIndex(
                name: "IX_Logs_CorrelationId",
                table: "Logs",
                column: "CorrelationId");

            migrationBuilder.CreateIndex(
                name: "IX_Logs_OrderNo",
                table: "Logs",
                column: "OrderNo");

            migrationBuilder.CreateIndex(
                name: "IX_Logs_Timestamp",
                table: "Logs",
                column: "Timestamp");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "Logs");

            migrationBuilder.DropColumn(
                name: "CorrelationId",
                table: "Orders");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251025103151_AddLogsAndCorrelationId.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251025103151_AddLogsAndCorrelationId")]
    partial class AddLogsAndCorrelationId
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "9.0.10");

            modelBuilder.Entity("Entities.Model.Log", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CorrelationId")
                        .HasColumnType("TEXT");

                    b.Property<string>("Exception")
                        .HasColumnType("TEXT");

                    b.Property<string>("Level")
                        .IsRequired()
                        .HasMaxLength(20)
                        .HasColumnType("TEXT");

                    b.Property<string>("Message")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<int?>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Properties")
                        .HasColumnType("TEXT");

                    b.Property<string>("ServiceName")
                        .IsRequired()
                        .HasMaxLength(50)
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("Timestamp")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("CorrelationId");

                    b.HasIndex("OrderNo");

                    b.HasIndex("Timestamp");

                    b.ToTable("Logs");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CorrelationId")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("CustomerId")
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderState")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders", t =>
                        {
                            t.Property("CustomerId")
                                .HasColumnName("Order_CustomerId");
                        });
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("Status")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasMaxLength(20)
                        .HasColumnType("TEXT")
                        .HasDefaultValue("Pending");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.OrderSentToPicking", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<DateTime>("SentTime")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("OrderSentToPickings");
                });

            modelBuilder.Entity("Entities.Model.Outbox", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<string>("MessageType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("TEXT");

                    b.Property<string>("Payload")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("ProcessedAt")
                        .HasColumnType("TEXT");

                    b.Property<int>("RetryCount")
                        .HasColumnType("INTEGER");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ProcessedAt");

                    b.ToTable("OutboxMessages");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_State");

                            b1.Property<string>("Street")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Street");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Customer", "Customer", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("Email")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerEmail");

                            b1.Property<string>("FirstName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerFirstName");

                            b1.Property<Guid>("Id")
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerId");

                            b1.Property<string>("LastName")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerLastName");

                            b1.Property<string>("Phone")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("CustomerPhone");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.OwnsOne("Entities.Model.Payment", "Payment", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<decimal>("Amount")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentAmount");

                            b1.Property<string>("Currency")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Currency");

                            b1.Property<DateTime?>("PaidAt")
                                .HasColumnType("TEXT")
                                .HasColumnName("PaidAt");

                            b1.Property<string>("PaymentMethod")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentMethod");

                            b1.Property<string>("PaymentStatus")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("PaymentStatus");

                            b1.HasKey("OrderId");

                            b1.ToTable("Orders");

                            b1.WithOwner()
                                .HasForeignKey("OrderId");
                        });

                    b.Navigation("Customer")
                        .IsRequired();

                    b.Navigation("Payment")
                        .IsRequired();

                    b.Navigation("ShippingAddress")
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.HasOne("Entities.Model.Order", null)
                        .WithMany("OrderItems")
                        .HasForeignKey("OrderId")
                        .OnDelete(DeleteBehavior.Cascade)
                        .IsRequired();
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Navigation("OrderItems");
                });
#pragma warning restore 612, 618
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251029163235_AddMassTransitOutbox.cs
================================================
﻿using System;
using Microsoft.EntityFrameworkCore.Migrations;

#nullable disable

namespace ERPApi.Migrations
{
    /// <inheritdoc />
    public partial class AddMassTransitOutbox : Migration
    {
        /// <inheritdoc />
        protected override void Up(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "Logs");

            migrationBuilder.CreateTable(
                name: "InboxState",
                columns: table => new
                {
                    Id = table.Column<long>(type: "INTEGER", nullable: false)
                        .Annotation("Sqlite:Autoincrement", true),
                    MessageId = table.Column<Guid>(type: "TEXT", nullable: false),
                    ConsumerId = table.Column<Guid>(type: "TEXT", nullable: false),
                    LockId = table.Column<Guid>(type: "TEXT", nullable: false),
                    RowVersion = table.Column<byte[]>(type: "BLOB", rowVersion: true, nullable: true),
                    Received = table.Column<DateTime>(type: "TEXT", nullable: false),
                    ReceiveCount = table.Column<int>(type: "INTEGER", nullable: false),
                    ExpirationTime = table.Column<DateTime>(type: "TEXT", nullable: true),
                    Consumed = table.Column<DateTime>(type: "TEXT", nullable: true),
                    Delivered = table.Column<DateTime>(type: "TEXT", nullable: true),
                    LastSequenceNumber = table.Column<long>(type: "INTEGER", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_InboxState", x => x.Id);
                    table.UniqueConstraint("AK_InboxState_MessageId_ConsumerId", x => new { x.MessageId, x.ConsumerId });
                });

            migrationBuilder.CreateTable(
                name: "OutboxState",
                columns: table => new
                {
                    OutboxId = table.Column<Guid>(type: "TEXT", nullable: false),
                    LockId = table.Column<Guid>(type: "TEXT", nullable: false),
                    RowVersion = table.Column<byte[]>(type: "BLOB", rowVersion: true, nullable: true),
                    Created = table.Column<DateTime>(type: "TEXT", nullable: false),
                    Delivered = table.Column<DateTime>(type: "TEXT", nullable: true),
                    LastSequenceNumber = table.Column<long>(type: "INTEGER", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_OutboxState", x => x.OutboxId);
                });

            migrationBuilder.CreateTable(
                name: "OutboxMessage",
                columns: table => new
                {
                    SequenceNumber = table.Column<long>(type: "INTEGER", nullable: false)
                        .Annotation("Sqlite:Autoincrement", true),
                    EnqueueTime = table.Column<DateTime>(type: "TEXT", nullable: true),
                    SentTime = table.Column<DateTime>(type: "TEXT", nullable: false),
                    Headers = table.Column<string>(type: "TEXT", nullable: true),
                    Properties = table.Column<string>(type: "TEXT", nullable: true),
                    InboxMessageId = table.Column<Guid>(type: "TEXT", nullable: true),
                    InboxConsumerId = table.Column<Guid>(type: "TEXT", nullable: true),
                    OutboxId = table.Column<Guid>(type: "TEXT", nullable: true),
                    MessageId = table.Column<Guid>(type: "TEXT", nullable: false),
                    ContentType = table.Column<string>(type: "TEXT", maxLength: 256, nullable: false),
                    MessageType = table.Column<string>(type: "TEXT", nullable: false),
                    Body = table.Column<string>(type: "TEXT", nullable: false),
                    ConversationId = table.Column<Guid>(type: "TEXT", nullable: true),
                    CorrelationId = table.Column<Guid>(type: "TEXT", nullable: true),
                    InitiatorId = table.Column<Guid>(type: "TEXT", nullable: true),
                    RequestId = table.Column<Guid>(type: "TEXT", nullable: true),
                    SourceAddress = table.Column<string>(type: "TEXT", maxLength: 256, nullable: true),
                    DestinationAddress = table.Column<string>(type: "TEXT", maxLength: 256, nullable: true),
                    ResponseAddress = table.Column<string>(type: "TEXT", maxLength: 256, nullable: true),
                    FaultAddress = table.Column<string>(type: "TEXT", maxLength: 256, nullable: true),
                    ExpirationTime = table.Column<DateTime>(type: "TEXT", nullable: true)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_OutboxMessage", x => x.SequenceNumber);
                    table.ForeignKey(
                        name: "FK_OutboxMessage_InboxState_InboxMessageId_InboxConsumerId",
                        columns: x => new { x.InboxMessageId, x.InboxConsumerId },
                        principalTable: "InboxState",
                        principalColumns: new[] { "MessageId", "ConsumerId" });
                    table.ForeignKey(
                        name: "FK_OutboxMessage_OutboxState_OutboxId",
                        column: x => x.OutboxId,
                        principalTable: "OutboxState",
                        principalColumn: "OutboxId");
                });

            migrationBuilder.CreateIndex(
                name: "IX_InboxState_Delivered",
                table: "InboxState",
                column: "Delivered");

            migrationBuilder.CreateIndex(
                name: "IX_OutboxMessage_EnqueueTime",
                table: "OutboxMessage",
                column: "EnqueueTime");

            migrationBuilder.CreateIndex(
                name: "IX_OutboxMessage_ExpirationTime",
                table: "OutboxMessage",
                column: "ExpirationTime");

            migrationBuilder.CreateIndex(
                name: "IX_OutboxMessage_InboxMessageId_InboxConsumerId_SequenceNumber",
                table: "OutboxMessage",
                columns: new[] { "InboxMessageId", "InboxConsumerId", "SequenceNumber" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_OutboxMessage_OutboxId_SequenceNumber",
                table: "OutboxMessage",
                columns: new[] { "OutboxId", "SequenceNumber" },
                unique: true);

            migrationBuilder.CreateIndex(
                name: "IX_OutboxState_Created",
                table: "OutboxState",
                column: "Created");
        }

        /// <inheritdoc />
        protected override void Down(MigrationBuilder migrationBuilder)
        {
            migrationBuilder.DropTable(
                name: "OutboxMessage");

            migrationBuilder.DropTable(
                name: "InboxState");

            migrationBuilder.DropTable(
                name: "OutboxState");

            migrationBuilder.CreateTable(
                name: "Logs",
                columns: table => new
                {
                    Id = table.Column<Guid>(type: "TEXT", nullable: false),
                    CorrelationId = table.Column<string>(type: "TEXT", nullable: true),
                    Exception = table.Column<string>(type: "TEXT", nullable: true),
                    Level = table.Column<string>(type: "TEXT", maxLength: 20, nullable: false),
                    Message = table.Column<string>(type: "TEXT", nullable: false),
                    OrderNo = table.Column<int>(type: "INTEGER", nullable: true),
                    Properties = table.Column<string>(type: "TEXT", nullable: true),
                    ServiceName = table.Column<string>(type: "TEXT", maxLength: 50, nullable: false),
                    Timestamp = table.Column<DateTime>(type: "TEXT", nullable: false)
                },
                constraints: table =>
                {
                    table.PrimaryKey("PK_Logs", x => x.Id);
                });

            migrationBuilder.CreateIndex(
                name: "IX_Logs_CorrelationId",
                table: "Logs",
                column: "CorrelationId");

            migrationBuilder.CreateIndex(
                name: "IX_Logs_OrderNo",
                table: "Logs",
                column: "OrderNo");

            migrationBuilder.CreateIndex(
                name: "IX_Logs_Timestamp",
                table: "Logs",
                column: "Timestamp");
        }
    }
}



================================================
FILE: ERPApi/Migrations/20251029163235_AddMassTransitOutbox.Designer.cs
================================================
﻿// <auto-generated />
using System;
using ERPApi.DBContext;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Infrastructure;
using Microsoft.EntityFrameworkCore.Migrations;
using Microsoft.EntityFrameworkCore.Storage.ValueConversion;

#nullable disable

namespace ERPApi.Migrations
{
    [DbContext(typeof(OrderDbContext))]
    [Migration("20251029163235_AddMassTransitOutbox")]
    partial class AddMassTransitOutbox
    {
        /// <inheritdoc />
        protected override void BuildTargetModel(ModelBuilder modelBuilder)
        {
#pragma warning disable 612, 618
            modelBuilder.HasAnnotation("ProductVersion", "9.0.10");

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("CorrelationId")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("CountryCode")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("CustomerId")
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<string>("OrderState")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<decimal>("TotalAmount")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderNo")
                        .IsUnique();

                    b.ToTable("Orders", t =>
                        {
                            t.Property("CustomerId")
                                .HasColumnName("Order_CustomerId");
                        });
                });

            modelBuilder.Entity("Entities.Model.OrderItem", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<string>("Name")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid>("OrderId")
                        .HasColumnType("TEXT");

                    b.Property<int>("Quantity")
                        .HasColumnType("INTEGER");

                    b.Property<string>("Sku")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("Status")
                        .IsRequired()
                        .ValueGeneratedOnAdd()
                        .HasMaxLength(20)
                        .HasColumnType("TEXT")
                        .HasDefaultValue("Pending");

                    b.Property<decimal>("TotalPrice")
                        .HasColumnType("TEXT");

                    b.Property<decimal>("UnitPrice")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.HasIndex("OrderId");

                    b.ToTable("OrderItems");
                });

            modelBuilder.Entity("Entities.Model.OrderSentToPicking", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<int>("OrderNo")
                        .HasColumnType("INTEGER");

                    b.Property<DateTime>("SentTime")
                        .HasColumnType("TEXT");

                    b.HasKey("Id");

                    b.ToTable("OrderSentToPickings");
                });

            modelBuilder.Entity("Entities.Model.Outbox", b =>
                {
                    b.Property<Guid>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("CreatedAt")
                        .HasColumnType("TEXT");

                    b.Property<string>("MessageType")
                        .IsRequired()
                        .HasMaxLength(100)
                        .HasColumnType("TEXT");

                    b.Property<string>("Payload")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("ProcessedAt")
                        .HasColumnType("TEXT");

                    b.Property<int>("RetryCount")
                        .HasColumnType("INTEGER");

                    b.HasKey("Id");

                    b.HasIndex("CreatedAt");

                    b.HasIndex("ProcessedAt");

                    b.ToTable("OutboxMessages");
                });

            modelBuilder.Entity("MassTransit.EntityFrameworkCoreIntegration.InboxState", b =>
                {
                    b.Property<long>("Id")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("INTEGER");

                    b.Property<DateTime?>("Consumed")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("ConsumerId")
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("Delivered")
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("ExpirationTime")
                        .HasColumnType("TEXT");

                    b.Property<long?>("LastSequenceNumber")
                        .HasColumnType("INTEGER");

                    b.Property<Guid>("LockId")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("MessageId")
                        .HasColumnType("TEXT");

                    b.Property<int>("ReceiveCount")
                        .HasColumnType("INTEGER");

                    b.Property<DateTime>("Received")
                        .HasColumnType("TEXT");

                    b.Property<byte[]>("RowVersion")
                        .IsConcurrencyToken()
                        .ValueGeneratedOnAddOrUpdate()
                        .HasColumnType("BLOB");

                    b.HasKey("Id");

                    b.HasIndex("Delivered");

                    b.ToTable("InboxState");
                });

            modelBuilder.Entity("MassTransit.EntityFrameworkCoreIntegration.OutboxMessage", b =>
                {
                    b.Property<long>("SequenceNumber")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("INTEGER");

                    b.Property<string>("Body")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<string>("ContentType")
                        .IsRequired()
                        .HasMaxLength(256)
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("ConversationId")
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("CorrelationId")
                        .HasColumnType("TEXT");

                    b.Property<string>("DestinationAddress")
                        .HasMaxLength(256)
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("EnqueueTime")
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("ExpirationTime")
                        .HasColumnType("TEXT");

                    b.Property<string>("FaultAddress")
                        .HasMaxLength(256)
                        .HasColumnType("TEXT");

                    b.Property<string>("Headers")
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("InboxConsumerId")
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("InboxMessageId")
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("InitiatorId")
                        .HasColumnType("TEXT");

                    b.Property<Guid>("MessageId")
                        .HasColumnType("TEXT");

                    b.Property<string>("MessageType")
                        .IsRequired()
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("OutboxId")
                        .HasColumnType("TEXT");

                    b.Property<string>("Properties")
                        .HasColumnType("TEXT");

                    b.Property<Guid?>("RequestId")
                        .HasColumnType("TEXT");

                    b.Property<string>("ResponseAddress")
                        .HasMaxLength(256)
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("SentTime")
                        .HasColumnType("TEXT");

                    b.Property<string>("SourceAddress")
                        .HasMaxLength(256)
                        .HasColumnType("TEXT");

                    b.HasKey("SequenceNumber");

                    b.HasIndex("EnqueueTime");

                    b.HasIndex("ExpirationTime");

                    b.HasIndex("OutboxId", "SequenceNumber")
                        .IsUnique();

                    b.HasIndex("InboxMessageId", "InboxConsumerId", "SequenceNumber")
                        .IsUnique();

                    b.ToTable("OutboxMessage");
                });

            modelBuilder.Entity("MassTransit.EntityFrameworkCoreIntegration.OutboxState", b =>
                {
                    b.Property<Guid>("OutboxId")
                        .ValueGeneratedOnAdd()
                        .HasColumnType("TEXT");

                    b.Property<DateTime>("Created")
                        .HasColumnType("TEXT");

                    b.Property<DateTime?>("Delivered")
                        .HasColumnType("TEXT");

                    b.Property<long?>("LastSequenceNumber")
                        .HasColumnType("INTEGER");

                    b.Property<Guid>("LockId")
                        .HasColumnType("TEXT");

                    b.Property<byte[]>("RowVersion")
                        .IsConcurrencyToken()
                        .ValueGeneratedOnAddOrUpdate()
                        .HasColumnType("BLOB");

                    b.HasKey("OutboxId");

                    b.HasIndex("Created");

                    b.ToTable("OutboxState");
                });

            modelBuilder.Entity("Entities.Model.Order", b =>
                {
                    b.OwnsOne("Entities.Model.Address", "ShippingAddress", b1 =>
                        {
                            b1.Property<Guid>("OrderId")
                                .HasColumnType("TEXT");

                            b1.Property<string>("City")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_City");

                            b1.Property<string>("Country")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_Country");

                            b1.Property<string>("PostalCode")
                                .IsRequired()
                                .HasColumnType("TEXT")
                                .HasColumnName("Ship_PostalCode");

                            b1.Property<string>("State")
                                .